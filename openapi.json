{
    "openapi": "3.1.0",
    "info": {
        "title": "CueBX",
        "description": "\nCueBX is a multi-product SaaS platform that provides AI-powered developer tools and career services through a unified API.\n\n## Products\n\n- **CueBX API** \u2014 Workspace-based developer tooling with team collaboration, role-based access, and per-seat billing.\n- **CueBX Career** \u2014 Individual subscription service for AI-assisted career development.\n\n## Key Capabilities\n\n| Area | Description |\n|------|-------------|\n| **Authentication** | Email/password signup with OTP verification, OAuth (Google & GitHub), JWT access/refresh tokens, and session management. |\n| **Workspaces** | Create and manage team workspaces with member invitations, role assignments (owner/admin/member), ownership transfer, and API key provisioning. |\n| **Subscriptions** | Stripe-powered billing with plan browsing, checkout sessions, seat management, plan upgrades with proration previews, and cancellation/reactivation. |\n| **Usage Tracking** | Metered usage validation and commitment via internal API, with quota enforcement and rate limiting per plan tier. |\n| **Webhooks** | Stripe event ingestion for real-time subscription lifecycle sync (checkout completed, subscription updated/deleted, payment failed). |\n\n## Authentication\n\nMost endpoints require a **Bearer JWT** obtained via `/auth/signin` or `/auth/oauth/{provider}/callback`. Internal service-to-service endpoints use an **API key** header (`X-Internal-API-Key`).\n",
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost:8000"
        }
    ],
    "paths": {
        "/auth/signup": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Sign up with email",
                "description": "## Create a New User Account\n\nRegister a new user with email and password credentials. Upon successful\nregistration, a **6-digit OTP verification code** is sent to the provided\nemail address.\n\n### Authentication Flow\n\n1. **Submit signup request** with email, password, and optional full name\n2. **Receive OTP** via email (valid for 10 minutes)\n3. **Verify email** using `POST /auth/signup/verify` with the OTP\n4. **Receive tokens** upon successful verification\n\n### Password Requirements\n\n- Minimum **8 characters**\n- At least **one uppercase letter** (A-Z)\n- At least **one lowercase letter** (a-z)\n- At least **one digit** (0-9)\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `email` | string | \u2705 | Valid email address |\n| `password` | string | \u2705 | Password meeting complexity requirements |\n| `full_name` | string | \u274c | User's display name (1-255 chars) |\n\n### Success Response (201)\n\nReturns confirmation that verification code was sent:\n\n```json\n{\n  \"message\": \"Verification code sent to your email\",\n  \"email\": \"user@example.com\",\n  \"requires_verification\": true\n}\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `409 Conflict` | Email already registered |\n| `422 Unprocessable Entity` | Invalid email format or password requirements not met |\n\n### Notes\n\n- The user account is created in an **unverified state**\n- Email verification is **required** before the user can sign in\n- If the email fails to send, the account is still created (retry with `/signup/resend`)",
                "operationId": "signup_auth_signup_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/SignupRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SignupResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Email already registered",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "User with this email already exists."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/signup/verify": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Verify email and complete signup",
                "description": "## Complete Email Verification\n\nVerify the user's email address using the OTP code sent during signup.\nOn successful verification, the user receives authentication tokens and\ncan immediately access protected resources.\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `email` | string | \u2705 | Email address the OTP was sent to |\n| `otp_code` | string | \u2705 | 6-digit verification code |\n\n### Success Response (200)\n\nReturns JWT tokens for authentication:\n\n```json\n{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"refresh_token\": \"dGhpcyBpcyBhIHJlZnJl...\",\n  \"token_type\": \"bearer\",\n  \"expires_in\": 900\n}\n```\n\n### Token Details\n\n| Token | Lifetime | Purpose |\n|-------|----------|--------|\n| `access_token` | 15 minutes | Used in `Authorization: Bearer <token>` header |\n| `refresh_token` | 7 days | Used to obtain new access tokens |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `400 Bad Request` | Invalid OTP code or expired |\n| `404 Not Found` | User with this email doesn't exist |\n| `422 Unprocessable Entity` | Invalid OTP format (must be 6 digits) |\n| `429 Too Many Requests` | Exceeded maximum verification attempts (5) |\n\n### Notes\n\n- OTP codes expire after **10 minutes**\n- Maximum **5 verification attempts** per OTP\n- After 5 failed attempts, request a new code via `/signup/resend`\n- Device info is captured from `User-Agent` header for session tracking",
                "operationId": "verify_signup_auth_signup_verify_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/OTPVerifyRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/TokenResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid or expired OTP code",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Invalid verification code"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "User not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Too many verification attempts",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Too many verification attempts. Please request a new code."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/signup/resend": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Resend verification code",
                "description": "## Resend Email Verification Code\n\nRequest a new OTP verification code to be sent to the user's email.\nUse this when the original code has expired or wasn't received.\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `email` | string | \u2705 | Email address to send OTP to |\n\n### Success Response (200)\n\n```json\n{\n  \"message\": \"Verification code sent to your email\",\n  \"success\": true\n}\n```\n\n### Security Behavior\n\nFor security reasons, this endpoint **always returns success** even if:\n- The email doesn't exist in the system\n- The email is already verified\n\nThis prevents email enumeration attacks.\n\n### Conditional Responses\n\n| Scenario | Response |\n|----------|----------|\n| Email exists & unverified | New OTP sent, `success: true` |\n| Email already verified | `success: false`, message indicates already verified |\n| Email not found | `success: true` (security measure) |\n\n### Notes\n\n- Previous OTP codes are **invalidated** when a new one is sent\n- Rate limiting may apply (check `429` responses)\n- New OTP is valid for **10 minutes**",
                "operationId": "resend_verification_auth_signup_resend_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ResendOTPRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/signin": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Sign in with email",
                "description": "## Sign In with Email & Password\n\nAuthenticate a user with their email and password credentials.\nReturns JWT tokens for accessing protected resources.\n\n### Request Body\n\n| Field | Type | Required | Default | Description |\n|-------|------|----------|---------|-------------|\n| `email` | string | \u2705 | - | User's registered email |\n| `password` | string | \u2705 | - | User's password |\n| `remember_me` | boolean | \u274c | `false` | Extend session duration |\n\n### Session Duration\n\n| `remember_me` | Refresh Token Lifetime |\n|---------------|------------------------|\n| `false` | 7 days |\n| `true` | 30 days |\n\n### Success Response (200)\n\n```json\n{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"refresh_token\": \"dGhpcyBpcyBhIHJlZnJl...\",\n  \"token_type\": \"bearer\",\n  \"expires_in\": 900\n}\n```\n\n### Using the Tokens\n\nInclude the access token in the `Authorization` header:\n\n```http\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIs...\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Invalid email/password, unverified email, or disabled account |\n| `422 Unprocessable Entity` | Invalid request format |\n\n### Prerequisites\n\n- User must have **verified their email** via OTP\n- Account must be **active** (not soft-deleted)\n\n### Notes\n\n- Device info captured from `User-Agent` for session management\n- Each sign-in creates a new session (viewable via `/auth/sessions`)\n- OAuth-only users (no password) cannot use this endpoint",
                "operationId": "signin_auth_signin_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LoginRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/TokenResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials or unverified email",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "invalid_credentials": {
                                        "summary": "Invalid email or password",
                                        "value": {
                                            "detail": "Invalid email or password"
                                        }
                                    },
                                    "email_not_verified": {
                                        "summary": "Email not verified",
                                        "value": {
                                            "detail": "Email not verified. Please verify your email first."
                                        }
                                    },
                                    "account_disabled": {
                                        "summary": "Account disabled",
                                        "value": {
                                            "detail": "Account is disabled."
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/token/refresh": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Refresh access token",
                "description": "## Refresh Access Token\n\nExchange a valid refresh token for a new access token. Use this endpoint\nwhen the access token has expired to maintain the user's session without\nrequiring re-authentication.\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `refresh_token` | string | \u2705 | The refresh token from sign-in/signup |\n\n### Success Response (200)\n\n```json\n{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"token_type\": \"bearer\",\n  \"expires_in\": 900\n}\n```\n\n### Token Lifecycle\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Access Token   \u2502     \u2502  Refresh Token  \u2502\n\u2502   (15 minutes)  \u2502     \u2502  (7-30 days)    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                       \u2502\n         \u25bc                       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Expired?     \u2502 Yes \u2502 POST /token/    \u2502\n\u2502                 \u2502\u2500\u2500\u2500\u2500\u25b6\u2502    refresh      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                 \u2502\n                                 \u25bc\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502  New Access     \u2502\n                        \u2502    Token        \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Token is invalid, expired, or revoked |\n| `422 Unprocessable Entity` | Missing refresh_token field |\n\n### Notes\n\n- The **refresh token itself is not rotated** (same token remains valid)\n- Refresh tokens can be revoked via `/signout` or `/signout/all`\n- If refresh token expires, user must sign in again\n- User account must still be active for refresh to succeed",
                "operationId": "refresh_token_auth_token_refresh_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RefreshTokenRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AccessTokenResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid, expired, or revoked refresh token",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "invalid_token": {
                                        "summary": "Invalid token",
                                        "value": {
                                            "detail": "Invalid refresh token."
                                        }
                                    },
                                    "expired_token": {
                                        "summary": "Token expired",
                                        "value": {
                                            "detail": "Refresh token has expired."
                                        }
                                    },
                                    "revoked_token": {
                                        "summary": "Token revoked",
                                        "value": {
                                            "detail": "Refresh token has been revoked."
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/signout": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Sign out",
                "description": "## Sign Out (Single Device)\n\nRevoke a specific refresh token, effectively signing out from one device/session.\nThe associated access tokens will no longer be refreshable.\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `refresh_token` | string | \u2705 | The refresh token to revoke |\n\n### Success Responses (200)\n\n**Token successfully revoked:**\n```json\n{\n  \"message\": \"Successfully signed out\",\n  \"success\": true\n}\n```\n\n**Token not found or already revoked:**\n```json\n{\n  \"message\": \"Token not found or already revoked\",\n  \"success\": false\n}\n```\n\n### Behavior\n\n| Scenario | Result |\n|----------|--------|\n| Valid token | Token revoked, `success: true` |\n| Already revoked | No change, `success: false` |\n| Invalid/unknown token | No change, `success: false` |\n\n### Notes\n\n- This endpoint **does not require authentication** (stateless signout)\n- Existing access tokens remain valid until they expire (15 min)\n- For immediate invalidation across all devices, use `/signout/all`\n- Does not affect other sessions/devices",
                "operationId": "signout_auth_signout_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RefreshTokenRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/signout/all": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Sign out all devices",
                "description": "## Sign Out (All Devices)\n\nRevoke **all** refresh tokens for the authenticated user, signing them out\nfrom every device and session. Useful for security incidents or when\nchanging sensitive account settings.\n\n### Authentication Required\n\n```http\nAuthorization: Bearer <access_token>\n```\n\n### Success Response (200)\n\n```json\n{\n  \"message\": \"Signed out from 3 device(s)\",\n  \"success\": true\n}\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Missing or invalid access token |\n\n### Use Cases\n\n- \ud83d\udd12 **Security breach** - Suspect unauthorized access\n- \ud83d\udd11 **Password change** - Automatically called after password change\n- \ud83d\udcf1 **Lost device** - Revoke access from lost/stolen device\n- \ud83e\uddf9 **Session cleanup** - Clear all old sessions\n\n### Notes\n\n- Requires a valid **access token** (unlike single-device signout)\n- The current session is **also revoked**\n- Returns count of revoked sessions for confirmation\n- Access tokens remain valid until expiry (15 min max)",
                "operationId": "signout_all_auth_signout_all_post",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Not authenticated",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Not authenticated"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/auth/oauth/{provider}": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Initiate OAuth flow",
                "description": "## Initiate OAuth Authentication\n\nBegin the OAuth 2.0 authorization flow with a supported provider.\nReturns an authorization URL to redirect the user to the provider's\nconsent screen.\n\n### Supported Providers\n\n| Provider | Path Value | Scopes Requested |\n|----------|------------|------------------|\n| Google | `google` | `openid`, `email`, `profile` |\n| GitHub | `github` | `user:email`, `read:user` |\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `provider` | string | OAuth provider: `google` or `github` |\n\n### Query Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| `remember_me` | boolean | `false` | Extend session to 30 days |\n| `callback_url` | string | `null` | Frontend URL for redirect after OAuth |\n\n### Success Response (200)\n\n```json\n{\n  \"authorization_url\": \"https://accounts.google.com/o/oauth2/v2/auth?...\",\n  \"state\": \"eyJhbGciOiJIUzI1NiIs...\"\n}\n```\n\n### OAuth Flow Diagram\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Client  \u2502     \u2502   Backend   \u2502     \u2502   Provider   \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                  \u2502                   \u2502\n     \u2502 GET /oauth/google\u2502                   \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502                   \u2502\n     \u2502                  \u2502                   \u2502\n     \u2502 authorization_url\u2502                   \u2502\n     \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                   \u2502\n     \u2502                  \u2502                   \u2502\n     \u2502 Redirect user to authorization_url  \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502\n     \u2502                  \u2502                   \u2502\n     \u2502                  \u2502  User consents    \u2502\n     \u2502                  \u2502                   \u2502\n     \u2502 Redirect to callback with code       \u2502\n     \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n     \u2502                  \u2502                   \u2502\n     \u2502                  \u2502                   \u2502\n```\n\n### Callback URL Validation\n\nIf `callback_url` is provided:\n- Must be in the configured **CORS origins** list\n- Must use **HTTPS** in production environments\n- Tokens will be returned as **URL fragment** parameters\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `400 Bad Request` | Invalid callback URL |\n| `422 Unprocessable Entity` | Invalid provider value |\n\n### Next Steps\n\n1. Redirect user to `authorization_url`\n2. User authenticates with provider\n3. Provider redirects to `/oauth/{provider}/callback`\n4. Tokens returned (JSON or URL fragment based on `callback_url`)",
                "operationId": "oauth_init_auth_oauth__provider__get",
                "parameters": [
                    {
                        "name": "provider",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "$ref": "#/components/schemas/OAuthProviders"
                        }
                    },
                    {
                        "name": "remember_me",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "description": "Extend session to 30 days",
                            "default": false,
                            "title": "Remember Me"
                        },
                        "description": "Extend session to 30 days"
                    },
                    {
                        "name": "callback_url",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "description": "Frontend callback URL for redirect after OAuth. Must be in CORS origins.",
                            "title": "Callback Url"
                        },
                        "description": "Frontend callback URL for redirect after OAuth. Must be in CORS origins."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/OAuthInitResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid callback URL",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Invalid callback URL. Must be in allowed origins and use HTTPS in production."
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Invalid provider",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": [
                                        {
                                            "type": "enum",
                                            "loc": [
                                                "path",
                                                "provider"
                                            ],
                                            "msg": "Input should be 'google' or 'github'"
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/oauth/{provider}/callback": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "OAuth callback",
                "description": "## OAuth Callback Handler\n\nHandle the OAuth provider callback after user authorization. This endpoint:\n\n1. Validates the CSRF state parameter\n2. Exchanges the authorization code for provider tokens\n3. Retrieves user profile from the provider\n4. Creates or links user account\n5. Issues application tokens\n\n### Query Parameters\n\n| Parameter | Type | Source | Description |\n|-----------|------|--------|-------------|\n| `code` | string | Provider | Authorization code from OAuth provider (absent on cancel) |\n| `state` | string | Provider | CSRF state from `/oauth/{provider}` init |\n| `error` | string | Provider | Error code if user cancelled or provider error (e.g., `access_denied`) |\n| `error_description` | string | Provider | Human-readable error description (optional) |\n\n### Response Behavior\n\nThe response depends on whether `callback_url` was provided during init:\n\n#### Without `callback_url` \u2192 JSON Response (200)\n\n```json\n{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"refresh_token\": \"dGhpcyBpcyBhIHJlZnJl...\",\n  \"token_type\": \"bearer\",\n  \"expires_in\": 900\n}\n```\n\n#### With `callback_url` \u2192 Redirect (307)\n\nRedirects to:\n```\n{callback_url}#access_token=...&refresh_token=...&token_type=bearer&expires_in=900\n```\n\n> \u26a0\ufe0f **Note:** Tokens are in the **URL fragment** (`#`), not query params (`?`).\n> This prevents tokens from being logged in server access logs.\n\n### User Account Handling\n\n| Scenario | Behavior |\n|----------|----------|\n| New email | Create new user account |\n| Existing email (same provider) | Sign in to existing account |\n| Existing email (different provider) | Link OAuth to existing account |\n| Existing email (has password) | Link OAuth, preserve password |\n\n### Error Responses\n\n| Status | Scenario | Behavior |\n|--------|----------|----------|\n| `400` | Invalid/expired state | JSON error (can't redirect) |\n| `307` | OAuth error + callback_url | Redirect to `{callback_url}?error=...` |\n| `400` | OAuth error, no callback_url | JSON error response |\n\n### Error Redirect Format\n\nWhen `callback_url` is set and an error occurs:\n```\n{callback_url}?error=oauth_error&error_description=...\n```\n\n### User Cancellation\n\nIf the user cancels on the provider's consent page, the provider redirects back\nwith an `error` parameter (e.g., `access_denied`). This endpoint detects the\ncancellation and redirects to `callback_url` with the error details passed through.\n\n### Security Notes\n\n- State parameter expires after **10 minutes**\n- State is cryptographically signed to prevent tampering\n- Authorization codes are **single-use** (provider enforced)\n- Email from provider is automatically marked as **verified**",
                "operationId": "oauth_callback_auth_oauth__provider__callback_get",
                "parameters": [
                    {
                        "name": "provider",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "$ref": "#/components/schemas/OAuthProviders"
                        }
                    },
                    {
                        "name": "code",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "description": "Authorization code from provider",
                            "title": "Code"
                        },
                        "description": "Authorization code from provider"
                    },
                    {
                        "name": "state",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "description": "State parameter for CSRF validation",
                            "title": "State"
                        },
                        "description": "State parameter for CSRF validation"
                    },
                    {
                        "name": "error",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "description": "Error code from provider (e.g., access_denied)",
                            "title": "Error"
                        },
                        "description": "Error code from provider (e.g., access_denied)"
                    },
                    {
                        "name": "error_description",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "description": "Human-readable error description",
                            "title": "Error Description"
                        },
                        "description": "Human-readable error description"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/TokenResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "OAuth error or invalid state",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "invalid_state": {
                                        "summary": "Invalid state parameter",
                                        "value": {
                                            "detail": "Invalid state parameter."
                                        }
                                    },
                                    "oauth_error": {
                                        "summary": "OAuth provider error",
                                        "value": {
                                            "detail": "OAuth authentication failed"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "307": {
                        "description": "Redirect to frontend callback URL with tokens in fragment",
                        "headers": {
                            "Location": {
                                "description": "Redirect URL with tokens: `{callback_url}#access_token=...&refresh_token=...`",
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/password/reset": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Request password reset",
                "description": "## Request Password Reset\n\nInitiate the password reset flow by sending a 6-digit OTP code\nto the user's registered email address.\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `email` | string | \u2705 | Email address of the account |\n\n### Success Response (200)\n\n```json\n{\n  \"message\": \"If the email exists and has a password, a reset code has been sent\",\n  \"success\": true\n}\n```\n\n### Security Design\n\nThis endpoint **always returns the same response** regardless of:\n- Whether the email exists\n- Whether the user has a password set\n- Whether the email was successfully sent\n\nThis prevents **email enumeration attacks** where attackers could\ndiscover which emails are registered.\n\n### Conditions for OTP to be Sent\n\n| Condition | OTP Sent? |\n|-----------|----------|\n| Email exists + has password | \u2705 Yes |\n| Email exists + OAuth-only (no password) | \u274c No |\n| Email doesn't exist | \u274c No |\n\n### Next Steps\n\n1. User receives OTP via email (valid for **10 minutes**)\n2. Submit OTP + new password to `/password/reset/confirm`\n\n### Notes\n\n- Previous reset OTPs are invalidated when requesting a new one\n- OAuth-only users should sign in with their OAuth provider\n- Rate limiting may apply to prevent abuse",
                "operationId": "request_password_reset_auth_password_reset_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PasswordResetRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/password/reset/confirm": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Confirm password reset",
                "description": "## Confirm Password Reset\n\nComplete the password reset process by verifying the OTP and setting\na new password. All existing sessions are revoked for security.\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `email` | string | \u2705 | Email address of the account |\n| `otp_code` | string | \u2705 | 6-digit verification code |\n| `new_password` | string | \u2705 | New password (see requirements) |\n\n### Password Requirements\n\n- Minimum **8 characters**\n- At least **one uppercase letter** (A-Z)\n- At least **one lowercase letter** (a-z)\n- At least **one digit** (0-9)\n\n### Success Response (200)\n\n```json\n{\n  \"message\": \"Password has been reset successfully\",\n  \"success\": true\n}\n```\n\n### Security Actions on Success\n\n1. \u2705 Password updated\n2. \u2705 OTP invalidated\n3. \u2705 **All refresh tokens revoked** (signs out all devices)\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `400 Bad Request` | Invalid or expired OTP code |\n| `422 Unprocessable Entity` | Invalid OTP format or password requirements not met |\n| `429 Too Many Requests` | Exceeded 5 verification attempts |\n\n### Notes\n\n- OTP codes expire after **10 minutes**\n- Maximum **5 attempts** per OTP, then must request new code\n- User must sign in again after password reset\n- If OTP attempts exhausted, request new code via `/password/reset`",
                "operationId": "confirm_password_reset_auth_password_reset_confirm_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PasswordResetConfirmRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid or expired OTP",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Invalid verification code"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Too many verification attempts",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Too many verification attempts. Please request a new code."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/password/change": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Change password",
                "description": "## Change Password\n\nUpdate the password for the currently authenticated user. Requires\nverification of the current password for security.\n\n### Authentication Required\n\n```http\nAuthorization: Bearer <access_token>\n```\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `current_password` | string | \u2705 | User's current password |\n| `new_password` | string | \u2705 | New password (see requirements) |\n\n### Password Requirements\n\n- Minimum **8 characters**\n- At least **one uppercase letter** (A-Z)\n- At least **one lowercase letter** (a-z)\n- At least **one digit** (0-9)\n\n### Success Response (200)\n\n```json\n{\n  \"message\": \"Password changed successfully. You have been signed out from other devices.\",\n  \"success\": true\n}\n```\n\n### Security Actions on Success\n\n1. \u2705 Password updated\n2. \u2705 **All other sessions revoked** (current session preserved)\n3. \u2705 Event logged for audit trail\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Not authenticated or current password incorrect |\n| `422 Unprocessable Entity` | Password requirements not met |\n\n### Notes\n\n- OAuth-only users must first set a password via different flow\n- Current session remains active after password change\n- All **other** devices/sessions are signed out\n- Consider using this when security is a concern",
                "operationId": "change_password_auth_password_change_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ChangePasswordRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Not authenticated or current password incorrect",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "not_authenticated": {
                                        "summary": "Not authenticated",
                                        "value": {
                                            "detail": "Not authenticated"
                                        }
                                    },
                                    "wrong_password": {
                                        "summary": "Current password incorrect",
                                        "value": {
                                            "detail": "Current password is incorrect"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/auth/me": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get current user profile",
                "description": "## Get Current User Profile\n\nRetrieve the complete profile information for the authenticated user,\nincluding account status, OAuth connections, and metadata.\n\n### Authentication Required\n\n```http\nAuthorization: Bearer <access_token>\n```\n\n### Success Response (200)\n\n```json\n{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"email\": \"user@example.com\",\n  \"email_verified\": true,\n  \"full_name\": \"John Doe\",\n  \"avatar_url\": \"https://example.com/avatar.jpg\",\n  \"is_active\": true,\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"updated_at\": \"2024-01-20T14:22:00Z\",\n  \"has_password\": true,\n  \"oauth_providers\": [\"google\", \"github\"]\n}\n```\n\n### Response Fields\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Unique user identifier |\n| `email` | string | User's email address |\n| `email_verified` | boolean | Whether email is verified |\n| `full_name` | string | User's display name |\n| `avatar_url` | string | URL to profile picture |\n| `is_active` | boolean | Account active status |\n| `created_at` | datetime | Account creation timestamp |\n| `updated_at` | datetime | Last profile update timestamp |\n| `has_password` | boolean | `true` if user can sign in with password |\n| `oauth_providers` | array | List of linked OAuth providers |\n\n### Understanding `has_password`\n\n| Value | Meaning |\n|-------|--------|\n| `true` | User signed up with email/password OR has set a password |\n| `false` | OAuth-only user, cannot use password signin |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Missing or invalid access token |\n| `404 Not Found` | User deleted (edge case) |",
                "operationId": "get_profile_auth_me_get",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ProfileResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found (rare edge case)",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "User not found"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Not authenticated",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Not authenticated"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Delete account",
                "description": "## Delete User Account\n\nPermanently delete (soft delete) the authenticated user's account.\nThis action signs out all devices and marks the account as deleted.\n\n### Authentication Required\n\n```http\nAuthorization: Bearer <access_token>\n```\n\n### Success Response (200)\n\n```json\n{\n  \"message\": \"Account has been deleted\",\n  \"success\": true\n}\n```\n\n### What Happens on Deletion\n\n1. \u2705 Account marked as **soft deleted** (not permanently removed)\n2. \u2705 All refresh tokens **revoked** (signed out everywhere)\n3. \u2705 Email becomes **available** for new registration\n4. \u2705 OAuth connections **preserved** (for potential recovery)\n5. \u2705 Event **logged** for audit trail\n\n### Soft Delete vs Hard Delete\n\n| Aspect | Soft Delete (Current) |\n|--------|----------------------|\n| Data retained | \u2705 Yes (configurable period) |\n| Can recover | \u26a0\ufe0f Contact support |\n| Email reusable | \u2705 Yes |\n| Tokens valid | \u274c No |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Missing or invalid access token |\n\n### \u26a0\ufe0f Warning\n\nThis action:\n- **Signs out** the user from all devices immediately\n- Cannot be easily undone by the user\n- May result in **data loss** after the retention period\n\n### Notes\n\n- Consider implementing a confirmation step in your UI\n- Account recovery may be possible within a grace period (contact support)\n- Associated data (posts, comments, etc.) handling depends on application policy",
                "operationId": "delete_account_auth_me_delete",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Not authenticated",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Not authenticated"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            },
            "patch": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Update user profile",
                "description": "## Update User Profile\n\nPartially update the authenticated user's profile. Only provided fields\nare updated; omitted fields remain unchanged.\n\n### Authentication Required\n\n```http\nAuthorization: Bearer <access_token>\n```\n\n### Request Body (all fields optional)\n\n| Field | Type | Constraints | Description |\n|-------|------|-------------|-------------|\n| `full_name` | string | 1-255 chars | User's display name |\n| `avatar_url` | string | max 512 chars | URL to profile picture |\n\n### Example Request\n\n```json\n{\n  \"full_name\": \"Jane Doe\"\n}\n```\n\nOnly `full_name` will be updated; `avatar_url` remains unchanged.\n\n### Success Response (200)\n\nReturns the complete updated profile:\n\n```json\n{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"email\": \"user@example.com\",\n  \"email_verified\": true,\n  \"full_name\": \"Jane Doe\",\n  \"avatar_url\": \"https://example.com/avatar.jpg\",\n  \"is_active\": true,\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"updated_at\": \"2024-01-21T09:15:00Z\",\n  \"has_password\": true,\n  \"oauth_providers\": [\"google\"]\n}\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Missing or invalid access token |\n| `404 Not Found` | User deleted (edge case) |\n| `422 Unprocessable Entity` | Validation failed (e.g., name too long) |\n\n### Notes\n\n- **Email cannot be changed** via this endpoint (requires verification flow)\n- Empty request body (`{}`) is valid (no changes made)\n- `updated_at` timestamp is refreshed on any change",
                "operationId": "update_profile_auth_me_patch",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ProfileUpdateRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ProfileResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found (rare edge case)",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "User not found"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Not authenticated",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Not authenticated"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/auth/me/avatar/upload-credentials": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get avatar upload credentials",
                "description": "## Get Avatar Upload Credentials\n\nGenerate signed Cloudinary credentials for secure client-side profile picture upload.\nThe frontend can use these credentials to upload directly to Cloudinary without\nexposing sensitive API secrets.\n\n### Authentication Required\n\n```http\nAuthorization: Bearer <access_token>\n```\n\n### Success Response (200)\n\n```json\n{\n  \"upload_url\": \"https://api.cloudinary.com/v1_1/your-cloud/image/upload\",\n  \"api_key\": \"123456789012345\",\n  \"timestamp\": 1706745600,\n  \"signature\": \"abcdef1234567890abcdef1234567890abcdef12\",\n  \"cloud_name\": \"your-cloud\",\n  \"folder\": \"avatars\",\n  \"resource_type\": \"image\",\n  \"upload_preset\": null,\n  \"eager\": null\n}\n```\n\n### Response Fields\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `upload_url` | string | Cloudinary upload endpoint URL |\n| `api_key` | string | Cloudinary API key (safe for frontend) |\n| `timestamp` | integer | Unix timestamp for signature validation |\n| `signature` | string | Signed hash for secure upload authentication |\n| `cloud_name` | string | Your Cloudinary cloud name |\n| `folder` | string | Target folder for uploaded avatars |\n| `resource_type` | string | Resource type (`image`) |\n| `upload_preset` | string | Upload preset (if configured) |\n| `eager` | string | Eager transformations (if any) |\n\n### Frontend Usage Example\n\n```javascript\n// 1. Get credentials from this endpoint\nconst response = await fetch('/auth/me/avatar/upload-credentials', {\n  headers: { 'Authorization': `Bearer ${accessToken}` }\n});\nconst credentials = await response.json();\n\n// 2. Upload directly to Cloudinary\nconst formData = new FormData();\nformData.append('file', selectedFile);\nformData.append('api_key', credentials.api_key);\nformData.append('timestamp', credentials.timestamp);\nformData.append('signature', credentials.signature);\nformData.append('folder', credentials.folder);\n\nconst uploadResponse = await fetch(credentials.upload_url, {\n  method: 'POST',\n  body: formData\n});\nconst result = await uploadResponse.json();\n\n// 3. Update profile with the returned URL\nawait fetch('/auth/me', {\n  method: 'PATCH',\n  headers: {\n    'Authorization': `Bearer ${accessToken}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({ avatar_url: result.secure_url })\n});\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Missing or invalid access token |\n| `500 Internal Server Error` | Cloudinary not configured |\n| `503 Service Unavailable` | Failed to generate credentials |\n\n### Notes\n\n- Credentials are **time-limited** (signature includes timestamp)\n- Files are uploaded to the `avatars` folder in Cloudinary\n- Only **image** uploads are allowed with these credentials\n- After upload, use `PATCH /auth/me` to update `avatar_url`",
                "operationId": "get_avatar_upload_credentials_auth_me_avatar_upload_credentials_get",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CloudinaryUploadCredentials"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Cloudinary not configured",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Cloudinary is not properly configured."
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Not authenticated",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Not authenticated"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "503": {
                        "description": "Failed to generate credentials",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Failed to generate upload credentials"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/auth/sessions": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get active sessions",
                "description": "## List Active Sessions\n\nRetrieve all active sessions (refresh tokens) for the authenticated user.\nUseful for session management UI where users can view and revoke sessions.\n\n### Authentication Required\n\n```http\nAuthorization: Bearer <access_token>\n```\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `refresh_token` | string | \u2705 | Current session's refresh token (to identify current session) |\n\n### Why POST instead of GET?\n\nThe current refresh token is needed to identify which session is the\n\"current\" one. Since tokens should not be passed in URLs (security),\nthis endpoint uses POST with a request body.\n\n### Success Response (200)\n\n```json\n{\n  \"sessions\": [\n    {\n      \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"device_info\": \"Chrome 120 on Windows\",\n      \"created_at\": \"2024-01-20T10:30:00Z\",\n      \"expires_at\": \"2024-01-27T10:30:00Z\",\n      \"is_current\": true\n    },\n    {\n      \"id\": \"660f9500-f30c-52e5-b827-557766551111\",\n      \"device_info\": \"Safari on iPhone\",\n      \"created_at\": \"2024-01-18T14:22:00Z\",\n      \"expires_at\": \"2024-02-17T14:22:00Z\",\n      \"is_current\": false\n    }\n  ],\n  \"total\": 2\n}\n```\n\n### Session Fields\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Session identifier |\n| `device_info` | string | Browser/device description (from User-Agent) |\n| `created_at` | datetime | When session was created (sign-in time) |\n| `expires_at` | datetime | When refresh token expires |\n| `is_current` | boolean | `true` if this is the requesting session |\n\n### Understanding `expires_at`\n\n| Sign-in Type | Expiration |\n|--------------|------------|\n| Normal (`remember_me: false`) | 7 days from sign-in |\n| Extended (`remember_me: true`) | 30 days from sign-in |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `401 Unauthorized` | Missing or invalid access token |\n| `422 Unprocessable Entity` | Missing refresh_token in body |\n\n### Use Cases\n\n- \ud83d\udcf1 **Session management UI** - Show users their active sessions\n- \ud83d\udd12 **Security audit** - Check for unauthorized sessions\n- \ud83e\uddf9 **Cleanup** - Identify old sessions to revoke\n\n### Notes\n\n- Only **active** (non-expired, non-revoked) sessions are returned\n- `device_info` may be `null` if User-Agent was not available\n- Use `/signout` to revoke individual sessions\n- Use `/signout/all` to revoke all sessions at once",
                "operationId": "get_sessions_auth_sessions_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RefreshTokenRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ActiveSessionsResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Not authenticated",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Not authenticated"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/webhooks/stripe": {
            "post": {
                "tags": [
                    "Webhooks",
                    "Webhooks"
                ],
                "summary": "Handle Stripe webhook events",
                "description": "Receives and processes Stripe webhook events with secure signature verification.\n\nThis endpoint is called by Stripe to notify the application of payment events.\nEvents are verified using webhook signature and then published to message queues\nfor asynchronous processing.\n\n**Handled Event Types:**\n- `checkout.session.completed` - New subscription checkout completed\n- `customer.subscription.created` - Subscription created\n- `customer.subscription.updated` - Subscription modified (plan change, renewal)\n- `customer.subscription.deleted` - Subscription cancelled\n- `customer.subscription.paused` - Subscription paused\n- `customer.subscription.resumed` - Subscription resumed\n- `invoice.paid` - Invoice successfully paid\n- `invoice.payment_failed` - Invoice payment failed\n- `invoice.payment_action_required` - Payment requires customer action (SCA)\n\n**Processing Flow:**\n1. Verify Stripe signature header\n2. Parse and validate event payload\n3. Publish to appropriate message queue\n4. Return 200 OK immediately (async processing)\n\n**Note:** This endpoint should only be called by Stripe's webhook system.\nConfigure the webhook URL in your Stripe Dashboard.",
                "operationId": "handle_stripe_webhook_webhooks_stripe_post",
                "responses": {
                    "200": {
                        "description": "Webhook received and processed",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "examples": {
                                    "received": {
                                        "summary": "Event received and queued",
                                        "value": {
                                            "status": "received"
                                        }
                                    },
                                    "ignored": {
                                        "summary": "Unhandled event type",
                                        "value": {
                                            "status": "ignored"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid request - missing signature or verification failed",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "missing_signature": {
                                        "summary": "Missing Stripe-Signature header",
                                        "value": {
                                            "detail": "Missing Stripe-Signature header"
                                        }
                                    },
                                    "invalid_signature": {
                                        "summary": "Signature verification failed",
                                        "value": {
                                            "detail": "Invalid signature"
                                        }
                                    },
                                    "missing_fields": {
                                        "summary": "Missing event id or type",
                                        "value": {
                                            "detail": "Missing event id or type"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal error - event could not be queued; Stripe will retry",
                        "content": {
                            "application/json": {
                                "example": {
                                    "status": "publish_failed"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces": {
            "get": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "List user workspaces",
                "description": "## List User Workspaces\n\nRetrieve all workspaces the authenticated user has access to as a member.\n\n### Authorization\n\n- User must be authenticated\n\n### Query Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| `member_role` | string | \u274c | Filter by user's role: `owner`, `admin`, or `member` |\n\n### Response\n\nReturns a list of workspaces with basic information:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `workspaces` | array | List of workspace objects |\n| `workspaces[].id` | UUID | Workspace identifier |\n| `workspaces[].display_name` | string | Workspace name |\n| `workspaces[].slug` | string | URL-friendly identifier |\n| `workspaces[].status` | string | `active` or `frozen` |\n| `workspaces[].is_personal` | boolean | Whether this is a personal workspace |\n| `workspaces[].owner_id` | UUID | Workspace owner's user ID |\n| `workspaces[].enabled_member_count` | integer | Count of enabled members |\n| `workspaces[].total_member_count` | integer | Total member count |\n\n### Notes\n\n- Includes both personal and team workspaces\n- Results include workspaces where user is owner, admin, or member\n- Use `member_role` to filter workspaces by your role in them",
                "operationId": "list_workspaces_api_workspaces_get",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "member_role",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "$ref": "#/components/schemas/MemberRole"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "title": "Member Role"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceListResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Create workspace",
                "description": "## Create New Workspace\n\nCreate a new team workspace. The authenticated user becomes the owner.\n\n### Authorization\n\n- User must be authenticated\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `display_name` | string | \u2705 | Workspace name (2-100 characters) |\n| `description` | string | \u274c | Optional description |\n\n### Response\n\nReturns the created workspace with details:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Workspace identifier |\n| `display_name` | string | Workspace name |\n| `slug` | string | Auto-generated URL-friendly identifier |\n| `status` | string | Always `active` for new workspaces |\n| `is_personal` | boolean | Always `false` for team workspaces |\n| `owner_id` | UUID | Creator's user ID |\n| `members` | array | Empty initially |\n| `seat_count` | integer | 0 until subscription is created |\n| `available_seats` | integer | 0 until subscription is created |\n\n### Workspace Creation Flow\n\n1. Workspace is created with owner as the only member\n2. Subscribe to a paid plan to enable invitations\n3. Invite team members\n4. Manage seats as needed\n\n### Notes\n\n- A subscription is required to invite members\n- Personal workspaces are created automatically at signup\n- Slug is auto-generated from display_name",
                "operationId": "create_workspace_api_workspaces_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/WorkspaceCreate"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Workspace created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceDetailResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}": {
            "get": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Get workspace details",
                "description": "## Get Workspace Details\n\nRetrieve detailed information about a specific workspace including members and subscription info.\n\n### Authorization\n\n- User must be a **member** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Workspace identifier |\n| `display_name` | string | Workspace name |\n| `slug` | string | URL-friendly identifier |\n| `status` | string | `active` or `frozen` |\n| `is_personal` | boolean | Personal workspace flag |\n| `description` | string | Optional description |\n| `owner_id` | UUID | Owner's user ID |\n| `members` | array | List of workspace members |\n| `seat_count` | integer | Total seats in subscription |\n| `available_seats` | integer | Seats available for new members |\n| `credits_used` | decimal | API credits used in current billing period |\n| `credits_limit` | decimal | Total API credits allocated by subscription |\n| `credits_remaining` | decimal | Remaining API credits (limit - used) |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | Workspace not found or access denied |\n\n### Notes\n\n- All members can view workspace details\n- Members list includes status (enabled/disabled)",
                "operationId": "get_workspace_api_workspaces__workspace_id__get",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceDetailResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Workspace not found or access denied",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Workspace not found or access denied."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            },
            "patch": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Update workspace",
                "description": "## Update Workspace Details\n\nUpdate workspace display name, slug, or description.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to update |\n\n### Request Body\n\nAll fields are optional. Only provided fields will be updated.\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `display_name` | string | \u274c | New workspace name |\n| `slug` | string | \u274c | New URL-friendly identifier |\n| `description` | string | \u274c | New description |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | Workspace not found |\n\n### Notes\n\n- Cannot update personal workspace settings\n- Slug must be unique across all workspaces",
                "operationId": "update_workspace_api_workspaces__workspace_id__patch",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/WorkspaceUpdate"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Workspace not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Workspace not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/members": {
            "get": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "List workspace members",
                "description": "## List Workspace Members\n\nRetrieve all members of a workspace with optional status filtering.\n\n### Authorization\n\n- User must be a **member** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n\n### Query Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| `status` | string | \u274c | Filter by status: `enabled` or `disabled` |\n\n### Response\n\nArray of member objects:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Member record ID |\n| `user_id` | UUID | User's ID |\n| `role` | string | `owner`, `admin`, or `member` |\n| `status` | string | `enabled` or `disabled` |\n| `joined_at` | datetime | When member joined |\n| `user_email` | string | Member's email |\n| `user_name` | string | Member's full name |\n| `user_avatar_url` | string | URL to member's avatar image |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | Workspace not found or access denied |\n\n### Notes\n\n- All members can view the member list\n- Disabled members cannot access the workspace",
                "operationId": "list_members_api_workspaces__workspace_id__members_get",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    },
                    {
                        "name": "status",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "$ref": "#/components/schemas/MemberStatus"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "title": "Status"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/WorkspaceMemberResponse"
                                    },
                                    "title": "Response List Members Api Workspaces  Workspace Id  Members Get"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Workspace not found or access denied",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Workspace not found or access denied."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/members/{member_user_id}/status": {
            "patch": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Update member status",
                "description": "## Enable or Disable Workspace Member\n\nChange a member's status between enabled and disabled. Disabled members cannot\naccess the workspace but remain in the member list.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n| `member_user_id` | UUID | The user ID of the member to update |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `status` | string | \u2705 | New status: `enabled` or `disabled` |\n\n### Response\n\nReturns the updated member object.\n\n### Status Behavior\n\n**Enabling a member:**\n- Requires an available seat\n- Member gains access to workspace\n\n**Disabling a member:**\n- Frees up a seat for other members\n- Member loses workspace access but remains in list\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `402 Payment Required` | No available seats to enable member |\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | Member not found |\n\n### Notes\n\n- Cannot disable yourself\n- Cannot disable the workspace owner\n- Enabling requires available seats in subscription",
                "operationId": "update_member_status_api_workspaces__workspace_id__members__member_user_id__status_patch",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    },
                    {
                        "name": "member_user_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Member User Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/MemberStatusUpdate"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceMemberResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Member not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Member not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "402": {
                        "description": "Insufficient seats",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No available seats. Purchase more seats to enable this member."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/members/{member_user_id}/role": {
            "patch": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Update member role",
                "description": "## Update Member Role\n\nChange a member's role within the workspace.\n\n### Authorization\n\n- User must be the **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n| `member_user_id` | UUID | The user ID of the member to update |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `role` | string | \u2705 | New role: `admin` or `member` |\n\n### Roles\n\n| Role | Description |\n|------|-------------|\n| `owner` | Full control, can delete workspace (cannot be assigned) |\n| `admin` | Manage members, invitations, subscription |\n| `member` | Basic workspace access |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not the workspace owner |\n| `404 Not Found` | Member not found |\n\n### Notes\n\n- Only workspace **owner** can change roles\n- Cannot change the owner role (use transfer ownership instead)\n- Admins can promote members to admin",
                "operationId": "update_member_role_api_workspaces__workspace_id__members__member_user_id__role_patch",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    },
                    {
                        "name": "member_user_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Member User Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/MemberRoleUpdate"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceMemberResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Member not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Member not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Owner permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Only workspace owner can change roles."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/members/{member_user_id}": {
            "delete": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Remove member",
                "description": "## Remove Workspace Member\n\nRemove a member from the workspace. The member loses all access and is\nremoved from the member list.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n| `member_user_id` | UUID | The user ID of the member to remove |\n\n### Response\n\n```json\n{\n  \"message\": \"Member removed successfully.\"\n}\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | Member not found |\n\n### Notes\n\n- Cannot remove yourself (use `/leave` instead)\n- Cannot remove the workspace owner\n- Removing a member frees up a seat\n- If member was enabled, available seats increase",
                "operationId": "remove_member_api_workspaces__workspace_id__members__member_user_id__delete",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    },
                    {
                        "name": "member_user_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Member User Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Member not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Member not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/leave": {
            "post": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Leave workspace",
                "description": "## Leave Workspace\n\nVoluntarily leave a workspace. The user loses all access.\n\n### Authorization\n\n- User must be a **member** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to leave |\n\n### Response\n\n```json\n{\n  \"message\": \"Successfully left workspace.\"\n}\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | Owner cannot leave (must transfer ownership first) |\n| `404 Not Found` | Not a member of this workspace |\n\n### Notes\n\n- **Owners cannot leave** - transfer ownership first\n- Leaving frees up a seat if you were enabled\n- To rejoin, you need a new invitation",
                "operationId": "leave_workspace_api_workspaces__workspace_id__leave_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not a member",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Not a member of this workspace."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Owner cannot leave",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Owner cannot leave workspace. Transfer ownership first."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/transfer-ownership": {
            "post": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Transfer ownership",
                "description": "## Transfer Workspace Ownership\n\nTransfer workspace ownership to another member. The current owner becomes\nan admin.\n\n### Authorization\n\n- User must be the **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n\n### Query Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| `new_owner_id` | UUID | \u2705 | User ID of the new owner |\n\n### Response\n\nReturns the updated workspace with new owner.\n\n### Ownership Transfer Process\n\n1. Current owner initiates transfer\n2. New owner must be an existing enabled member\n3. Current owner becomes admin\n4. New owner gains full control\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not the current owner |\n| `404 Not Found` | New owner is not a member |\n\n### Notes\n\n- Only workspace **owner** can transfer ownership\n- New owner must be an enabled member\n- Previous owner becomes admin (not removed)\n- This action cannot be undone",
                "operationId": "transfer_ownership_api_workspaces__workspace_id__transfer_ownership_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    },
                    {
                        "name": "new_owner_id",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "New Owner Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Member not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "New owner must be an existing member."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Owner permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Only workspace owner can transfer ownership."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/invitations": {
            "get": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "List invitations",
                "description": "## List Workspace Invitations\n\nRetrieve all pending invitations for a workspace.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `invitations` | array | List of invitation objects |\n| `invitations[].id` | UUID | Invitation identifier |\n| `invitations[].email` | string | Invited email address |\n| `invitations[].role` | string | Role to be assigned |\n| `invitations[].status` | string | `pending`, `accepted`, `expired` |\n| `invitations[].expires_at` | datetime | Expiration timestamp |\n| `invitations[].inviter_email` | string | Who sent the invitation |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n\n### Notes\n\n- Only pending invitations are typically shown\n- Expired invitations may still appear",
                "operationId": "list_invitations_api_workspaces__workspace_id__invitations_get",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/InvitationListResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Create invitation",
                "description": "## Invite User to Workspace\n\nSend an invitation to a user to join the workspace. The user will receive\nan invitation URL to accept.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `email` | string | \u2705 | Email address to invite |\n| `role` | string | \u274c | Role to assign: `admin` or `member` (default) |\n| `callback_url` | string | \u2705 | Frontend URL to redirect after accepting (must be in allowed origins) |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `invitation` | object | Created invitation details |\n| `invitation_url` | string | URL for the invitee to accept |\n\n### Invitation Flow\n\n1. Admin sends invitation with this endpoint\n2. System generates invitation token (valid 7 days)\n3. Send `invitation_url` to the invitee\n   - The `invitation_url` is the provided `callback_url` with the token as a query parameter\n4. Invitee logs in and calls `/invitations/accept`\n5. Invitee becomes a workspace member\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `400 Bad Request` | Cannot invite the owner |\n| `402 Payment Required` | No available seats or free workspace |\n| `403 Forbidden` | User is not admin or workspace is frozen |\n| `409 Conflict` | User already a member or invitation exists |\n\n### Notes\n\n- Requires available seats in subscription\n- Free workspaces cannot invite members\n- Frozen workspaces cannot send invitations\n- Existing members cannot be re-invited",
                "operationId": "create_invitation_api_workspaces__workspace_id__invitations_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/InvitationCreate"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Invitation created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/InvitationCreatedResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Already a member or invitation exists",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "User is already a member."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "402": {
                        "description": "Insufficient seats or free workspace",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No available seats."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required or workspace frozen",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/invitations/{invitation_id}": {
            "delete": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Revoke invitation",
                "description": "## Revoke Workspace Invitation\n\nRevoke a pending invitation. The invitation link will no longer work.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n| `invitation_id` | UUID | The invitation to revoke |\n\n### Response\n\n```json\n{\n  \"message\": \"Invitation revoked.\"\n}\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | Invitation not found |\n\n### Notes\n\n- Only pending invitations can be revoked\n- The invitee will receive an error if they try to use the link",
                "operationId": "revoke_invitation_api_workspaces__workspace_id__invitations__invitation_id__delete",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    },
                    {
                        "name": "invitation_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Invitation Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Invitation not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Invitation not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/invitations/accept": {
            "post": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Accept invitation",
                "description": "## Accept Workspace Invitation\n\nAccept an invitation to join a workspace using the invitation token.\n\n### Authorization\n\n- User must be authenticated\n- Token must match the user's email\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `token` | string | \u2705 | Invitation token from the invitation URL |\n\n### Response\n\nReturns the created member object:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Member record ID |\n| `user_id` | UUID | Your user ID |\n| `role` | string | Assigned role |\n| `status` | string | `enabled` |\n| `joined_at` | datetime | Current timestamp |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `402 Payment Required` | No available seats |\n| `404 Not Found` | Invalid or expired token |\n| `409 Conflict` | Already a member of this workspace |\n\n### Notes\n\n- Token is typically received via email or core link\n- Token expires after 7 days\n- Email must match the invitation email\n- If seats are full, the invitation cannot be accepted",
                "operationId": "accept_invitation_api_workspaces_invitations_accept_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/InvitationAccept"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceMemberResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Invalid or expired token",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Invitation not found or expired."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Already a member",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Already a member of this workspace."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "402": {
                        "description": "No available seats",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No available seats."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/api/workspaces/activate": {
            "post": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Activate personal workspace",
                "description": "## Activate Personal Workspace\n\nManually create or retrieve the user's personal workspace with a free subscription.\nThis is a fallback endpoint for users whose automatic workspace creation failed\nduring signup.\n\n### Authorization\n\n- User must be authenticated\n\n### Response\n\nReturns the personal workspace:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Workspace identifier |\n| `display_name` | string | User's name + \"'s Workspace\" |\n| `slug` | string | Auto-generated slug |\n| `status` | string | `active` |\n| `is_personal` | boolean | Always `true` |\n| `owner_id` | UUID | User's ID |\n\n### Idempotent Behavior\n\nThis endpoint is idempotent:\n- If personal workspace exists, returns it\n- If not, creates workspace + free subscription\n\n### Notes\n\n- Personal workspaces are automatically created at signup\n- This endpoint is a safety net for edge cases\n- Personal workspaces cannot be deleted\n- Each user can only have one personal workspace",
                "operationId": "activate_personal_workspace_api_workspaces_activate_post",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WorkspaceResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/api/workspaces/{workspace_id}/api-keys": {
            "post": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Create API key",
                "description": "## Create API Key\n\nGenerate a new API key for the workspace. The key is used to authenticate\nrequests to the external developer API.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `name` | string | \u2705 | User-defined label for the key (1-128 characters) |\n| `expires_in_days` | integer | \u274c | Days until expiry (1-365). Default: 90. |\n| `is_test_key` | boolean | \u274c | Whether this is a test key. Default: false. |\n\n### Key Types\n\n| Type | Prefix | Credits | Description |\n|------|--------|---------|-------------|\n| Live | `cbx_live_` | Charged | Production keys that consume credits |\n| Test | `cbx_test_` | Never | Development keys for testing (no credits charged) |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `api_key` | string | The full API key. **Store securely - shown only once!** |\n| `key` | object | API key metadata |\n| `key.id` | UUID | Key identifier |\n| `key.name` | string | User-defined label |\n| `key.key_prefix` | string | Display prefix for identification |\n| `key.is_active` | boolean | Whether key is active |\n| `key.is_test_key` | boolean | Whether this is a test key |\n| `key.expires_at` | datetime | Expiration timestamp (null if never) |\n| `message` | string | Security reminder |\n\n### Security Notes\n\n- The full API key is shown **only once** in this response\n- Store the key securely (e.g., environment variable, secrets manager)\n- The key cannot be retrieved again - if lost, revoke and create a new one\n- Keys are hashed with HMAC-SHA256 before storage\n\n### Error Responses\n\n| Status | Reason |\n|--------|---------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | Workspace not found |",
                "operationId": "create_api_key_api_workspaces__workspace_id__api_keys_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/APIKeyCreate"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "API key created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/APIKeyCreatedResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Workspace not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Workspace not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            },
            "get": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "List API keys",
                "description": "## List API Keys\n\nRetrieve all API keys for the workspace.\n\n### Authorization\n\n- User must be a **member** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `api_keys` | array | List of API key objects |\n| `api_keys[].id` | UUID | Key identifier |\n| `api_keys[].name` | string | User-defined label |\n| `api_keys[].key_prefix` | string | Display prefix for identification |\n| `api_keys[].is_active` | boolean | Whether key is active |\n| `api_keys[].created_at` | datetime | Creation timestamp |\n| `api_keys[].expires_at` | datetime | Expiration timestamp (null if never) |\n| `api_keys[].last_used_at` | datetime | Last usage timestamp (null if never used) |\n| `api_keys[].revoked_at` | datetime | Revocation timestamp (null if active) |\n\n### Notes\n\n- Only metadata is returned, never the actual key\n- Includes both active and revoked keys\n- Use `key_prefix` to identify keys (e.g., \"cbx_live_abc12...\")",
                "operationId": "list_api_keys_api_workspaces__workspace_id__api_keys_get",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/APIKeyListResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Workspace not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Workspace not found or access denied."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/workspaces/{workspace_id}/api-keys/{api_key_id}": {
            "delete": {
                "tags": [
                    "API - Workspaces"
                ],
                "summary": "Revoke API key",
                "description": "## Revoke API Key\n\nRevoke an API key. The key will immediately stop working.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace identifier |\n| `api_key_id` | UUID | The API key identifier |\n\n### Response\n\n```json\n{\n  \"message\": \"API key revoked.\"\n}\n```\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | API key not found |\n\n### Notes\n\n- Revocation is immediate and permanent\n- Revoked keys are kept in the list for audit purposes\n- Create a new key if needed after revocation",
                "operationId": "revoke_api_key_api_workspaces__workspace_id__api_keys__api_key_id__delete",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    },
                    {
                        "name": "api_key_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Api Key Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "API key not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "API key not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/plans": {
            "get": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "List all subscription plans",
                "description": "## List Available Subscription Plans\n\nRetrieve all active subscription plans available for workspace subscriptions.\nPlans are returned in order of price tier (Free \u2192 Pro \u2192 Enterprise).\n\n### Response\n\nReturns a list of plans, each containing:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Unique plan identifier |\n| `name` | string | Plan display name (e.g., \"Free\", \"Pro\") |\n| `description` | string | Plan description |\n| `price` | decimal | Monthly price in dollars |\n| `display_price` | string | Formatted price (e.g., \"$29/month\") |\n| `features` | array | List of plan features |\n| `max_seats` | integer | Maximum allowed seats |\n| `min_seats` | integer | Minimum required seats |\n\n### Example Response\n\n```json\n{\n  \"plans\": [\n    {\n      \"id\": \"550e8400-e29b-41d4-a716-446655440001\",\n      \"name\": \"Free\",\n      \"price\": 0.00,\n      \"max_seats\": 1,\n      \"features\": [...]\n    },\n    {\n      \"id\": \"550e8400-e29b-41d4-a716-446655440002\",\n      \"name\": \"Pro\",\n      \"price\": 29.00,\n      \"max_seats\": 10,\n      \"features\": [...]\n    }\n  ]\n}\n```\n\n### Notes\n\n- Only **active** plans are returned\n- Plans are specific to the **API product** (workspace-based)\n- For Career plans, use `/career/subscriptions/plans`",
                "operationId": "list_plans_api_subscriptions_plans_get",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PlanListResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/plans/{plan_id}": {
            "get": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Get plan details",
                "description": "## Get Subscription Plan Details\n\nRetrieve detailed information about a specific subscription plan.\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `plan_id` | UUID | The unique identifier of the plan |\n\n### Response\n\nReturns the complete plan details including all features and pricing information.\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | Plan does not exist or is inactive |\n\n### Notes\n\n- Both active and inactive plans can be retrieved by ID\n- Use this to display plan details before checkout",
                "operationId": "get_plan_api_subscriptions_plans__plan_id__get",
                "parameters": [
                    {
                        "name": "plan_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Plan Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PlanResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Plan not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Plan not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/workspaces/{workspace_id}": {
            "get": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Get workspace subscription",
                "description": "## Get Workspace Subscription\n\nRetrieve the current subscription for a workspace. Returns `null` if the\nworkspace has no active subscription.\n\n### Authorization\n\n- User must be a **member** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to get subscription for |\n\n### Response\n\nReturns the subscription details including:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Subscription identifier |\n| `workspace_id` | UUID | Associated workspace |\n| `plan_id` | UUID | Current plan |\n| `status` | string | Subscription status (`active`, `canceled`, `past_due`, etc.) |\n| `seat_count` | integer | Number of purchased seats |\n| `current_period_start` | datetime | Billing period start |\n| `current_period_end` | datetime | Billing period end |\n| `cancel_at_period_end` | boolean | Whether subscription will cancel at period end |\n| `credits_allocation` | decimal | Total credits allocated for the billing period |\n| `credits_used` | decimal | Credits consumed in the current billing period |\n| `plan` | object | Full plan details |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not a member of the workspace |\n\n### Notes\n\n- Returns `null` (not 404) if workspace exists but has no subscription\n- Personal workspaces automatically have a free subscription",
                "operationId": "get_workspace_subscription_api_subscriptions_workspaces__workspace_id__get",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "anyOf": [
                                        {
                                            "$ref": "#/components/schemas/SubscriptionResponse"
                                        },
                                        {
                                            "type": "null"
                                        }
                                    ],
                                    "title": "Response Get Workspace Subscription Api Subscriptions Workspaces  Workspace Id  Get"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access denied",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Access to this workspace is denied."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/workspaces/{workspace_id}/checkout": {
            "post": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Create checkout session",
                "description": "## Create Stripe Checkout Session\n\nCreate a Stripe checkout session to subscribe the workspace to a paid plan.\nRedirects the user to Stripe's hosted checkout page.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to subscribe |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `plan_id` | UUID | \u2705 | The plan to subscribe to |\n| `seat_count` | integer | \u274c | Number of seats (default: 1) |\n| `success_url` | string | \u2705 | URL to redirect after successful payment |\n| `cancel_url` | string | \u2705 | URL to redirect if user cancels |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `checkout_url` | string | Stripe checkout page URL |\n| `session_id` | string | Stripe session ID for tracking |\n\n### Checkout Flow\n\n1. Call this endpoint to create a checkout session\n2. Redirect user to `checkout_url`\n3. User completes payment on Stripe\n4. Stripe redirects to `success_url`\n5. Webhook updates subscription in database\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | Plan not found |\n| `400 Bad Request` | Invalid seat count for plan |\n\n### Notes\n\n- Seat count must be between plan's `min_seats` and `max_seats`\n- If workspace already has a subscription, upgrading should use `/upgrade` instead",
                "operationId": "create_checkout_api_subscriptions_workspaces__workspace_id__checkout_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CheckoutRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CheckoutResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/workspaces/{workspace_id}/seats": {
            "patch": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Update seat count",
                "description": "## Update Subscription Seat Count\n\nAdjust the number of seats on an active workspace subscription.\nChanges are prorated and take effect immediately.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to update |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `seat_count` | integer | \u2705 | New number of seats |\n\n### Response\n\nReturns the updated subscription with new seat count and billing details.\n\n### Proration Rules\n\n- **Adding seats**: Immediately billed for the prorated amount\n- **Removing seats**: Credit applied to next billing cycle\n- Cannot reduce seats below current member count\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | No active subscription found |\n| `400 Bad Request` | Seat count out of range or below member count |\n\n### Notes\n\n- Seat count must be between plan's `min_seats` and `max_seats`\n- Cannot reduce seats below current workspace member count\n- Changes update Stripe subscription immediately",
                "operationId": "update_seats_api_subscriptions_workspaces__workspace_id__seats_patch",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/SeatUpdateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SubscriptionResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid seat count",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Current seat count (5) exceeds target plan's maximum (3). Reduce seats before upgrading."
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "No active subscription",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No active subscription found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/workspaces/{workspace_id}/cancel": {
            "post": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Cancel subscription",
                "description": "## Cancel Workspace Subscription\n\nCancel the workspace subscription. By default, cancellation takes effect at the\nend of the current billing period, allowing continued access until then.\n\n### Authorization\n\n- User must be the **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to cancel subscription for |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `cancel_at_period_end` | boolean | \u274c | If `true` (default), cancels at period end. If `false`, cancels immediately |\n\n### Response\n\nReturns the updated subscription with cancellation details.\n\n### Cancellation Behavior\n\n**At Period End (`cancel_at_period_end=true`):**\n- Subscription remains active until `current_period_end`\n- Members retain full access\n- `cancel_at_period_end` flag is set to `true`\n- Can be reactivated before period ends\n\n**Immediate (`cancel_at_period_end=false`):**\n- Subscription cancelled immediately\n- Workspace becomes frozen\n- All members disabled except owner\n- Prorated refund issued (if applicable)\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not the workspace owner |\n| `404 Not Found` | No active subscription found |\n\n### Notes\n\n- Only workspace **owner** can cancel (not admins)\n- Immediate cancellation triggers workspace freeze\n- Resubscription requires checkout session",
                "operationId": "cancel_subscription_api_subscriptions_workspaces__workspace_id__cancel_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CancelSubscriptionRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SubscriptionResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Owner permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Only workspace owner can cancel subscription."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/workspaces/{workspace_id}/reactivate": {
            "post": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Reactivate workspace",
                "description": "## Reactivate Frozen Workspace\n\nReactivate a frozen workspace after subscription cancellation and resubscription.\nThis endpoint enables workspace access for specified members.\n\n### Authorization\n\n- User must be the **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to reactivate |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `member_ids_to_enable` | UUID[] | \u274c | List of member IDs to enable. If not specified, only owner is enabled |\n\n### Response\n\n```json\n{\n  \"message\": \"Workspace reactivated successfully.\"\n}\n```\n\n### Reactivation Flow\n\n1. Owner resubscribes to a plan (creates new subscription)\n2. Call this endpoint to unfreeze workspace\n3. Specify which members to enable (limited by seat count)\n4. Additional members can be enabled via seat management\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not the workspace owner |\n| `404 Not Found` | Workspace not found |\n| `400 Bad Request` | Requested members exceed seat count |\n\n### Notes\n\n- Only workspace **owner** can reactivate\n- Number of enabled members cannot exceed subscription seat count\n- Members not enabled remain in workspace but cannot access it",
                "operationId": "reactivate_workspace_api_subscriptions_workspaces__workspace_id__reactivate_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ReactivateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Owner permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Only workspace owner can reactivate workspace."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/workspaces/{workspace_id}/preview-upgrade": {
            "post": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Preview subscription change",
                "description": "## Preview Subscription Change Cost\n\nPreview the cost of changing subscription plan or seat count before committing.\nReturns detailed proration information showing charges and credits.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to preview upgrade for |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `new_plan_id` | UUID | \u274c | The plan to upgrade/downgrade to |\n| `new_seat_count` | integer | \u274c | Optional new seat count (for upgrades/downgrades) |\n\nAt least one of `new_plan_id` or `new_seat_count` must be provided.\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `current_plan_name` | string | Name of current plan |\n| `new_plan_name` | string | Name of new plan |\n| `current_seat_count` | integer | Current number of seats |\n| `new_seat_count` | integer | New number of seats (if changing) |\n| `proration_date` | datetime | When proration is calculated |\n| `amount_due` | integer | Amount to charge (in cents) |\n| `credit` | integer | Credit from unused time (in cents) |\n| `currency` | string | Currency code (e.g., \"usd\") |\n\n### Proration Calculation\n\nThe preview shows:\n- **Credit**: Unused time on current plan\n- **Charge**: Cost of new plan for remaining period\n- **Net Amount**: What will be charged at upgrade\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | No active subscription or plan not found |\n\n### Notes\n\n- This is a **preview only** - no changes are made\n- Use the `/upgrade` endpoint to execute the upgrade or `/seats` endpoint to change seats\n- Amounts are in the main currency unit (dollars for USD)",
                "operationId": "preview_subscription_change_api_subscriptions_workspaces__workspace_id__preview_upgrade_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpgradePreviewRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UpgradePreviewResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid seat count",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Current seat count (5) exceeds target plan's maximum (3). Reduce seats before upgrading."
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Subscription or plan not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No active subscription found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/subscriptions/workspaces/{workspace_id}/upgrade": {
            "post": {
                "tags": [
                    "API - Subscriptions"
                ],
                "summary": "Upgrade subscription plan",
                "description": "## Upgrade Subscription Plan\n\nUpgrade the workspace subscription to a different plan.\nProration is calculated and charged immediately.\n\n### Authorization\n\n- User must be an **admin** or **owner** of the workspace\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `workspace_id` | UUID | The workspace to upgrade |\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `new_plan_id` | UUID | \u2705 | The plan to upgrade to |\n\n### Response\n\nReturns the updated subscription with the new plan details.\n\n### Upgrade Process\n\n1. **Preview first**: Use `/preview-upgrade` to see costs\n2. **Execute upgrade**: Call this endpoint\n3. **Proration applied**: Charged immediately via Stripe\n4. **New plan active**: Takes effect immediately\n\n### Billing\n\n- Credit for unused time on old plan\n- Charge for remaining period on new plan\n- Net amount charged to payment method\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `403 Forbidden` | User is not an admin of the workspace |\n| `404 Not Found` | No active subscription or plan not found |\n| `400 Bad Request` | Invalid upgrade (e.g., current seats exceed new plan limit) |\n\n### Notes\n\n- Upgrades and downgrades are both supported\n- For downgrades, ensure current seat count fits new plan limits\n- Changes are reflected immediately in Stripe",
                "operationId": "upgrade_plan_api_subscriptions_workspaces__workspace_id__upgrade_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workspace_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Workspace Id"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpgradeRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/SubscriptionResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid seat count",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Current seat count (5) exceeds target plan's maximum (3). Reduce seats before upgrading."
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Subscription not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No active subscription found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Admin permission required",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Admin permission required."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/support/contact-sales": {
            "post": {
                "tags": [
                    "API - Support"
                ],
                "summary": "Submit a sales inquiry",
                "description": "## Submit Sales Inquiry\n\nSubmit a request to be contacted by the sales team.\n\n### Rate Limiting\n\n- **3 requests per email per hour**\n- Rate limit is based on the email address provided\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `first_name` | string | Yes | First name (1-255 chars) |\n| `last_name` | string | Yes | Last name (1-255 chars) |\n| `email` | string | Yes | Valid email address |\n| `message` | string | No | Optional message (max 5000 chars) |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Unique request identifier |\n| `message` | string | Confirmation message |\n| `status` | string | Request status (pending) |\n\n### Notes\n\n- No authentication required\n- Sales team will respond via the provided email",
                "operationId": "contact_sales_api_support_contact_sales_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ContactSalesRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ContactSalesResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate limit exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Try again in 3600 seconds."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/internal/usage/validate": {
            "post": {
                "tags": [
                    "API - Internal API"
                ],
                "summary": "Validate API key and log usage",
                "description": "Validate an API key and log usage for quota tracking.\n    \n    This endpoint is called by the external developer API to:\n    1. Validate the API key is valid, active, and not expired\n    2. Verify the API key belongs to the specified workspace (client_id)\n    3. Check workspace-level rate limits\n    4. Check workspace quota (credits used vs credits_allocation)\n    5. Create a PENDING usage log for quota tracking\n    6. Calculate and reserve credits for billing\n    7. Return access granted/denied with a usage_id, credits_reserved, and is_test_key\n    \n    **Key Types**:\n    | Type | Prefix | Behavior |\n    |------|--------|----------|\n    | Live | `cbx_live_` | Full quota enforcement, credits charged |\n    | Test | `cbx_test_` | Rate limits apply, zero credits, `is_test_key=true` |\n    \n    **Test Keys**: Test API keys (`cbx_test_` prefix) are designed for development\n    and testing. They bypass quota checks, always return `access: \"granted\"`, and\n    reserve zero credits. The response includes `is_test_key: true` to indicate\n    that the caller should return mocked/sample responses instead of real data.\n    Note: Rate limits still apply to test keys.\n    \n    **Rate Limiting**: Workspace-level rate limiting is enforced using sliding\n    windows for both per-minute and per-day limits. Limits are configurable\n    per plan via PlanPricingRule.\n    \n    **Rate Limit Response Headers** (Server B should forward these to developers):\n    | Header | Type | Description |\n    |--------|------|-------------|\n    | `X-RateLimit-Limit-Minute` | int | Max requests per minute for this workspace |\n    | `X-RateLimit-Remaining-Minute` | int | Remaining in current minute window |\n    | `X-RateLimit-Reset-Minute` | int | Unix timestamp when minute window resets |\n    | `X-RateLimit-Limit-Day` | int | Max requests per day for this workspace |\n    | `X-RateLimit-Remaining-Day` | int | Remaining in current day window |\n    | `X-RateLimit-Reset-Day` | int | Unix timestamp when day window resets |\n    | `Retry-After` | int | Seconds until rate limit resets (only included on 429 responses) |\n    \n    **Important**: Server B should copy these headers from this response to the response\n    it sends to developers. This allows developers to implement proper rate limit handling\n    (e.g., exponential backoff, request throttling) in their applications.\n    \n    **Note**: These headers are **not always present** (e.g., for idempotent requests or\n    early validation failures). Use `.get()` to safely access them and avoid KeyError:\n    ```python\n    limit_min = response.headers.get(\"X-RateLimit-Limit-Minute\")\n    remaining_min = response.headers.get(\"X-RateLimit-Remaining-Minute\")\n    reset_min = response.headers.get(\"X-RateLimit-Reset-Minute\")\n    limit_day = response.headers.get(\"X-RateLimit-Limit-Day\")\n    remaining_day = response.headers.get(\"X-RateLimit-Remaining-Day\")\n    reset_day = response.headers.get(\"X-RateLimit-Reset-Day\")\n    retry_after = response.headers.get(\"Retry-After\")  # Only on 429\n    ```\n    \n    **Idempotency**: Uses request_id + fingerprint (computed from endpoint,\n    method, payload_hash, usage_estimate, and feature_key) for true idempotency.\n    - Same request_id + same fingerprint = return existing access_status\n    - Same request_id + different fingerprint = create new record (different payload)\n    \n    The caller must then call /usage/commit to mark the usage as SUCCESS\n    or FAILED after the request completes. PENDING logs that are not\n    committed will be expired by a scheduled job.\n    \n    **Quota Enforcement**: The system checks if the workspace has sufficient\n    credits remaining in the current billing period. If quota is exceeded,\n    access is denied with HTTP 429. Test keys bypass quota checks entirely.\n    \n    **Usage Estimate Validation**: If `usage_estimate` is provided, at least\n    one field must be set (input_chars, max_output_tokens, or model). Fields\n    are validated with bounds: input_chars (0-10M), max_output_tokens (0-2M),\n    model (max 100 chars).\n    \n    **Security**: Requires X-Internal-API-Key header.\n    \n    **Status Codes**:\n    - 200: Access granted (quota available, test key, or idempotent request)\n    - 400: Invalid request format (bad client_id or API key format)\n    - 401: API key not found, expired, or revoked\n    - 403: API key does not belong to the specified workspace\n    - 429: Rate limit exceeded (per-minute or per-day) OR quota exceeded",
                "operationId": "validate_usage_api_internal_usage_validate_post",
                "parameters": [
                    {
                        "name": "x-internal-api-key",
                        "in": "header",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "title": "X-Internal-Api-Key"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/app__apps__cubex_api__schemas__workspace__UsageValidateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Access granted or idempotent request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsageValidateResponse"
                                },
                                "examples": {
                                    "granted": {
                                        "summary": "Access Granted (Live Key)",
                                        "value": {
                                            "access": "granted",
                                            "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Quota available. Remaining: 4500.0000 credits.",
                                            "credits_reserved": "1.0000",
                                            "is_test_key": false
                                        }
                                    },
                                    "granted_test_key": {
                                        "summary": "Access Granted (Test Key)",
                                        "value": {
                                            "access": "granted",
                                            "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Test key - access granted (no credits charged).",
                                            "credits_reserved": "0.0000",
                                            "is_test_key": true
                                        }
                                    },
                                    "granted_idempotent": {
                                        "summary": "Granted - Idempotent Request",
                                        "value": {
                                            "access": "granted",
                                            "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Request already processed (idempotent). Access: granted",
                                            "credits_reserved": "1.0000",
                                            "is_test_key": false
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid request format",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "invalid_client_id": {
                                        "summary": "Invalid Client ID",
                                        "value": {
                                            "access": "denied",
                                            "message": "Invalid client_id format. Expected: ws_<uuid_hex>",
                                            "is_test_key": false
                                        }
                                    },
                                    "invalid_api_key_format": {
                                        "summary": "Invalid API Key Format",
                                        "value": {
                                            "access": "denied",
                                            "message": "Invalid API key format.",
                                            "is_test_key": false
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "API key authentication failed",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "api_key_not_found": {
                                        "summary": "API Key Not Found",
                                        "value": {
                                            "access": "denied",
                                            "message": "API key not found, expired, or revoked.",
                                            "is_test_key": false
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate limit or quota exceeded",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "rate_limit_exceeded_minute": {
                                        "summary": "Rate Limit Exceeded (Per-Minute)",
                                        "description": "Response includes X-RateLimit-*-Minute, X-RateLimit-*-Day, and Retry-After headers",
                                        "value": {
                                            "access": "denied",
                                            "message": "Rate limit exceeded. Limit: 20 requests/minute. Try again in 45 seconds.",
                                            "is_test_key": false
                                        }
                                    },
                                    "rate_limit_exceeded_day": {
                                        "summary": "Rate Limit Exceeded (Per-Day)",
                                        "description": "Response includes X-RateLimit-*-Minute, X-RateLimit-*-Day, and Retry-After headers",
                                        "value": {
                                            "access": "denied",
                                            "message": "Rate limit exceeded. Limit: 500 requests/day. Try again in 3600 seconds.",
                                            "is_test_key": false
                                        }
                                    },
                                    "quota_exceeded": {
                                        "summary": "Quota Exceeded",
                                        "value": {
                                            "access": "denied",
                                            "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Quota exceeded. Current usage: 5000.0000, limit: 5000.0000",
                                            "credits_reserved": "1.0000",
                                            "is_test_key": false
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "API key does not belong to workspace",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "workspace_mismatch": {
                                        "summary": "Workspace Mismatch",
                                        "value": {
                                            "access": "denied",
                                            "message": "API key does not belong to the specified workspace.",
                                            "is_test_key": false
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/internal/usage/commit": {
            "post": {
                "tags": [
                    "API - Internal API"
                ],
                "summary": "Commit a usage log",
                "description": "Commit a pending usage log entry (idempotent).\n    \n    This endpoint is called by the external developer API after a request\n    completes to mark the usage as SUCCESS (counts toward quota) or FAILED\n    (does not count toward quota).\n    \n    **Async Alternative (RabbitMQ)**: Instead of calling this endpoint\n    synchronously, the caller can publish the same `UsageCommitRequest`\n    payload as a JSON message to the **`usage_commits`** RabbitMQ queue.\n    The message will be processed asynchronously by the usage commit handler.\n    - Retry queue: `usage_commits_retry` (30 s TTL, max 3 retries)\n    - Dead-letter queue: `usage_commits_dead`\n    \n    **Metrics (optional)**: When `success=True`, you can optionally provide\n    metrics about the request:\n    - `model_used`: Model identifier (e.g., \"gpt-4o\")\n    - `input_tokens`: Actual input tokens used (0-2,000,000)\n    - `output_tokens`: Actual output tokens generated (0-2,000,000)\n    - `latency_ms`: Request latency in milliseconds (0-3,600,000)\n    \n    **Failure Details (required when success=False)**: When `success=False`,\n    you MUST provide failure details:\n    - `failure_type`: Category of failure (internal_error, timeout, rate_limited,\n      invalid_response, upstream_error, client_error, validation_error)\n    - `reason`: Human-readable description of what went wrong (max 1000 chars)\n    \n    **Idempotent**: This operation is safe to retry. If the usage log\n    is already committed or doesn't exist, success is still returned.\n    \n    **Security**: Requires X-Internal-API-Key header.",
                "operationId": "commit_usage_api_internal_usage_commit_post",
                "parameters": [
                    {
                        "name": "x-internal-api-key",
                        "in": "header",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "title": "X-Internal-Api-Key"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/app__apps__cubex_api__schemas__workspace__UsageCommitRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Commit result",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsageCommitResponse"
                                },
                                "examples": {
                                    "success_with_metrics": {
                                        "summary": "Success with Metrics",
                                        "value": {
                                            "success": true,
                                            "message": "Usage committed as SUCCESS."
                                        }
                                    },
                                    "failed_with_details": {
                                        "summary": "Failed with Details",
                                        "value": {
                                            "success": true,
                                            "message": "Usage committed as FAILED."
                                        }
                                    },
                                    "already_committed": {
                                        "summary": "Already Committed (Idempotent)",
                                        "value": {
                                            "success": true,
                                            "message": "Usage log not found, but operation is idempotent."
                                        }
                                    },
                                    "ownership_mismatch": {
                                        "summary": "Ownership Mismatch",
                                        "value": {
                                            "success": false,
                                            "message": "API key does not own this usage log."
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid or missing internal API key"
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error (e.g., missing failure details when success=False)"
                    }
                }
            }
        },
        "/career/subscriptions/plans": {
            "get": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "List Career plans",
                "description": "## List Career Plans\n\nRetrieve all active Career subscription plans available for purchase.\n\n### Authorization\n\n- Public endpoint (no authentication required)\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `plans` | array | List of available plans |\n| `plans[].id` | UUID | Plan identifier |\n| `plans[].name` | string | Plan name (e.g., \"Career Free\", \"Career Pro\") |\n| `plans[].description` | string | Plan description |\n| `plans[].price` | decimal | Monthly price |\n| `plans[].display_price` | string | Formatted price string |\n| `plans[].type` | string | Always `career` |\n| `plans[].features` | array | Included features |\n\n### Notes\n\n- Only active plans are returned\n- Free tier is always available\n- Career plans are user-based (not workspace-based)",
                "operationId": "list_career_plans_career_subscriptions_plans_get",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PlanListResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                }
            }
        },
        "/career/subscriptions/plans/{plan_id}": {
            "get": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "Get Career plan details",
                "description": "## Get Career Plan Details\n\nRetrieve detailed information about a specific Career plan.\n\n### Authorization\n\n- Public endpoint (no authentication required)\n\n### Path Parameters\n\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| `plan_id` | UUID | The plan identifier |\n\n### Response\n\nReturns the complete plan details including all features.\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | Plan does not exist |\n\n### Notes\n\n- Both active and inactive plans can be retrieved by ID",
                "operationId": "get_career_plan_career_subscriptions_plans__plan_id__get",
                "parameters": [
                    {
                        "name": "plan_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "title": "Plan Id"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PlanResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Plan not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Plan not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/career/subscriptions": {
            "get": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "Get my Career subscription",
                "description": "## Get My Career Subscription\n\nRetrieve the current user's Career subscription. Returns `null` if no\nsubscription exists.\n\n### Authorization\n\n- User must be authenticated\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Subscription identifier |\n| `user_id` | UUID | User's ID |\n| `plan_id` | UUID | Current plan |\n| `status` | string | `active`, `canceled`, `past_due`, etc. |\n| `current_period_start` | datetime | Billing period start |\n| `current_period_end` | datetime | Billing period end |\n| `cancel_at_period_end` | boolean | Whether cancellation is scheduled |\n| `canceled_at` | datetime | When cancellation was requested |\n| `plan` | object | Full plan details |\n\n### Notes\n\n- Returns `null` (not 404) if user has no Career subscription\n- Users get a free Career subscription at signup",
                "operationId": "get_my_career_subscription_career_subscriptions_get",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "anyOf": [
                                        {
                                            "$ref": "#/components/schemas/CareerSubscriptionResponse"
                                        },
                                        {
                                            "type": "null"
                                        }
                                    ],
                                    "title": "Response Get My Career Subscription Career Subscriptions Get"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/career/subscriptions/checkout": {
            "post": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "Create Career checkout session",
                "description": "## Create Career Checkout Session\n\nCreate a Stripe checkout session to subscribe to a paid Career plan.\nRedirects the user to Stripe's hosted checkout page.\n\n### Authorization\n\n- User must be authenticated\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `plan_id` | UUID | \u2705 | The Career plan to subscribe to |\n| `success_url` | string | \u2705 | URL to redirect after successful payment |\n| `cancel_url` | string | \u2705 | URL to redirect if user cancels |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `checkout_url` | string | Stripe checkout page URL |\n| `session_id` | string | Stripe session ID for tracking |\n\n### Checkout Flow\n\n1. Call this endpoint to create a checkout session\n2. Redirect user to `checkout_url`\n3. User completes payment on Stripe\n4. Stripe redirects to `success_url`\n5. Webhook updates subscription in database\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | Plan not found |\n\n### Notes\n\n- Career subscriptions are per-user (no seat management)\n- Upgrading existing subscription should use `/upgrade` instead",
                "operationId": "create_career_checkout_career_subscriptions_checkout_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CareerCheckoutRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CareerCheckoutResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Plan not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Plan not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/career/subscriptions/preview-upgrade": {
            "post": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "Preview Career upgrade",
                "description": "## Preview Career Plan Upgrade Cost\n\nPreview the cost of upgrading to a different Career plan before committing.\nReturns detailed proration information.\n\n### Authorization\n\n- User must be authenticated\n- User must have an active Career subscription\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `new_plan_id` | UUID | \u2705 | The plan to upgrade to |\n\n### Response\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `current_plan` | string | Name of current plan |\n| `new_plan` | string | Name of new plan |\n| `proration_amount` | integer | Proration in cents |\n| `total_due` | decimal | Total to charge (in dollars) |\n| `currency` | string | Currency code (e.g., \"usd\") |\n| `billing_period_end` | datetime | Current period end date |\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | No active subscription or plan not found |\n\n### Notes\n\n- This is a **preview only** - no changes are made\n- Use the `/upgrade` endpoint to execute the upgrade",
                "operationId": "preview_career_upgrade_career_subscriptions_preview_upgrade_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CareerUpgradePreviewRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CareerUpgradePreviewResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Subscription or plan not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No active Career subscription found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/career/subscriptions/upgrade": {
            "post": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "Upgrade Career plan",
                "description": "## Upgrade Career Subscription Plan\n\nUpgrade the user's Career subscription to a different plan.\nProration is calculated and charged immediately.\n\n### Authorization\n\n- User must be authenticated\n- User must have an active Career subscription\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `new_plan_id` | UUID | \u2705 | The plan to upgrade to |\n\n### Response\n\nReturns the updated subscription with new plan details.\n\n### Upgrade Process\n\n1. **Preview first**: Use `/preview-upgrade` to see costs\n2. **Execute upgrade**: Call this endpoint\n3. **Proration applied**: Charged immediately via Stripe\n4. **New plan active**: Takes effect immediately\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | No active subscription or plan not found |\n\n### Notes\n\n- Upgrades and downgrades are both supported\n- Changes reflect immediately in Stripe",
                "operationId": "upgrade_career_plan_career_subscriptions_upgrade_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CareerUpgradeRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CareerSubscriptionResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Subscription not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No active Career subscription found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/career/subscriptions/cancel": {
            "post": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "Cancel Career subscription",
                "description": "## Cancel Career Subscription\n\nCancel the user's Career subscription. By default, cancellation takes effect\nat the end of the current billing period.\n\n### Authorization\n\n- User must be authenticated\n- User must have an active Career subscription\n\n### Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `cancel_at_period_end` | boolean | \u274c | If `true` (default), cancels at period end. If `false`, cancels immediately |\n\n### Response\n\n```json\n{\n  \"message\": \"Subscription will be cancelled at end of billing period.\",\n  \"success\": true\n}\n```\n\n### Cancellation Behavior\n\n**At Period End (`cancel_at_period_end=true`):**\n- Subscription remains active until `current_period_end`\n- User retains Career features until then\n- Can be reactivated before period ends\n\n**Immediate (`cancel_at_period_end=false`):**\n- Subscription cancelled immediately\n- User reverts to free tier\n- Prorated refund issued (if applicable)\n\n### Error Responses\n\n| Status | Reason |\n|--------|--------|\n| `404 Not Found` | No active subscription found |\n\n### Notes\n\n- After cancellation, user reverts to Career Free tier\n- Resubscription requires new checkout session",
                "operationId": "cancel_career_subscription_career_subscriptions_cancel_post",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CareerCancelRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CareerMessageResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Subscription not found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "No active Career subscription found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/career/subscriptions/activate": {
            "post": {
                "tags": [
                    "Career - Subscriptions"
                ],
                "summary": "Activate Career subscription",
                "description": "## Activate Career Subscription\n\nManually create a free Career subscription if one doesn't exist.\nThis is a fallback endpoint for users whose automatic subscription\ncreation failed during signup.\n\n### Authorization\n\n- User must be authenticated\n\n### Response\n\nReturns the Career subscription (created or existing):\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `id` | UUID | Subscription identifier |\n| `user_id` | UUID | User's ID |\n| `plan_id` | UUID | Free Career plan ID |\n| `status` | string | `active` |\n| `plan` | object | Free Career plan details |\n\n### Idempotent Behavior\n\nThis endpoint is idempotent:\n- If Career subscription exists, returns it\n- If not, creates free Career subscription\n\n### Notes\n\n- Career subscriptions are automatically created at signup\n- This endpoint is a safety net for edge cases\n- Always creates the free tier subscription",
                "operationId": "activate_career_subscription_career_subscriptions_activate_post",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CareerSubscriptionResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ]
            }
        },
        "/career/internal/usage/validate": {
            "post": {
                "tags": [
                    "Career - Internal API",
                    "Career - Internal API"
                ],
                "summary": "Validate user and log usage",
                "description": "Validate user quota and log usage for the career product.\n\n    This endpoint is called by the AI tool server to:\n    1. Authenticate the user via JWT (Bearer token)\n    2. Verify the user has an active career subscription\n    3. Check user-level rate limits (per-minute and per-day)\n    4. Check user quota (credits used vs credits_allocation)\n    5. Create a PENDING usage log for quota tracking\n    6. Calculate and reserve credits for billing\n    7. Return access granted/denied with a usage_id and credits_reserved\n\n    **Rate Limiting**: User-level rate limiting is enforced using sliding\n    windows for both per-minute and per-day limits. Limits are configurable\n    per plan via PlanPricingRule.\n\n    **Rate Limit Response Headers** (AI tool server should forward these):\n    | Header | Type | Description |\n    |--------|------|-------------|\n    | `X-RateLimit-Limit-Minute` | int | Max requests per minute |\n    | `X-RateLimit-Remaining-Minute` | int | Remaining in current minute window |\n    | `X-RateLimit-Reset-Minute` | int | Unix timestamp when minute window resets |\n    | `X-RateLimit-Limit-Day` | int | Max requests per day |\n    | `X-RateLimit-Remaining-Day` | int | Remaining in current day window |\n    | `X-RateLimit-Reset-Day` | int | Unix timestamp when day window resets |\n    | `Retry-After` | int | Seconds until rate limit resets (only on 429) |\n\n    **Note**: These headers are **not always present** (e.g., for idempotent\n    requests or early validation failures like 402). Use `.get()` to safely\n    access them.\n\n    **Idempotency**: Uses request_id + fingerprint (computed from endpoint,\n    method, payload_hash, usage_estimate, and feature_key) for true\n    idempotency.\n    - Same request_id + same fingerprint = return existing access_status\n    - Same request_id + different fingerprint = create new record\n\n    The caller must then call /usage/commit to mark the usage as SUCCESS\n    or FAILED after the request completes. PENDING logs that are not\n    committed will be expired by a scheduled job.\n\n    **Quota Enforcement**: The system checks if the user has sufficient\n    credits remaining in the current billing period. If quota is exceeded,\n    access is denied with HTTP 429.\n\n    **Usage Estimate Validation**: If `usage_estimate` is provided, at least\n    one field must be set (input_chars, max_output_tokens, or model). Fields\n    are validated with bounds: input_chars (0-10M), max_output_tokens (0-2M),\n    model (max 100 chars).\n\n    **Security**: Requires Bearer JWT token AND X-Internal-API-Key header.\n\n    **Status Codes**:\n    - 200: Access granted (quota available or idempotent request)\n    - 402: No active career subscription found\n    - 429: Rate limit exceeded (per-minute or per-day) OR quota exceeded",
                "operationId": "validate_usage_career_internal_usage_validate_post",
                "security": [
                    {
                        "HTTPBearer": []
                    }
                ],
                "parameters": [
                    {
                        "name": "x-internal-api-key",
                        "in": "header",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "title": "X-Internal-Api-Key"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UsageValidateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Access granted or idempotent request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/app__apps__cubex_career__schemas__internal__UsageValidateResponse"
                                },
                                "examples": {
                                    "granted": {
                                        "summary": "Access Granted",
                                        "value": {
                                            "access": "granted",
                                            "user_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Access granted. 98.50 credits remaining after this request.",
                                            "credits_reserved": "1.50"
                                        }
                                    },
                                    "granted_idempotent": {
                                        "summary": "Granted - Idempotent Request",
                                        "value": {
                                            "access": "granted",
                                            "user_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Request already processed (idempotent). Access: granted",
                                            "credits_reserved": "1.50"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate limit or quota exceeded",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "rate_limit_exceeded_minute": {
                                        "summary": "Rate Limit Exceeded (per-minute)",
                                        "value": {
                                            "access": "denied",
                                            "user_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Rate limit exceeded. Limit: 20 requests/minute. Try again in 45 seconds."
                                        }
                                    },
                                    "rate_limit_exceeded_day": {
                                        "summary": "Rate Limit Exceeded (per-day)",
                                        "value": {
                                            "access": "denied",
                                            "user_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Rate limit exceeded. Limit: 200 requests/day. Try again in 3600 seconds."
                                        }
                                    },
                                    "quota_exceeded": {
                                        "summary": "Quota Exceeded",
                                        "value": {
                                            "access": "denied",
                                            "user_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "Quota exceeded. Used 100.00/100.00 credits. This request requires 1.50 credits.",
                                            "credits_reserved": "1.50"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "402": {
                        "description": "No active career subscription",
                        "content": {
                            "application/json": {
                                "examples": {
                                    "no_subscription": {
                                        "summary": "No Active Subscription",
                                        "value": {
                                            "access": "denied",
                                            "user_id": "550e8400-e29b-41d4-a716-446655440000",
                                            "message": "No active career subscription found."
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation Error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HTTPValidationError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/career/internal/usage/commit": {
            "post": {
                "tags": [
                    "Career - Internal API",
                    "Career - Internal API"
                ],
                "summary": "Commit a usage log",
                "description": "Commit a pending usage log entry (idempotent).\n\n    This endpoint is called by the AI tool server after a request\n    completes to mark the usage as SUCCESS (counts toward quota) or FAILED\n    (does not count toward quota).\n\n    **Async Alternative (RabbitMQ)**: Instead of calling this endpoint\n    synchronously, the caller can publish the same `UsageCommitRequest`\n    payload as a JSON message to the **`career_usage_commits`** RabbitMQ\n    queue. The message will be processed asynchronously by the career\n    usage commit handler.\n    - Retry queue: `career_usage_commits_retry` (30 s TTL, max 3 retries)\n    - Dead-letter queue: `career_usage_commits_dead`\n\n    **Metrics (optional)**: When `success=True`, you can optionally provide\n    metrics about the request:\n    - `model_used`: Model identifier (e.g., \"gpt-4o\")\n    - `input_tokens`: Actual input tokens used (0-2,000,000)\n    - `output_tokens`: Actual output tokens generated (0-2,000,000)\n    - `latency_ms`: Request latency in milliseconds (0-3,600,000)\n\n    **Failure Details (required when success=False)**: When `success=False`,\n    you MUST provide failure details:\n    - `failure_type`: Category of failure (internal_error, timeout,\n      rate_limited, invalid_response, upstream_error, client_error,\n      validation_error)\n    - `reason`: Human-readable description (max 1000 chars)\n\n    **Idempotent**: Safe to retry. If the usage log is already committed\n    or doesn't exist, success is still returned.\n\n    **Security**: Requires X-Internal-API-Key header. No JWT needed \u2014\n    the `user_id` is passed in the request body and ownership is verified\n    against the usage log record.",
                "operationId": "commit_usage_career_internal_usage_commit_post",
                "parameters": [
                    {
                        "name": "x-internal-api-key",
                        "in": "header",
                        "required": false,
                        "schema": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "title": "X-Internal-Api-Key"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UsageCommitRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Commit result",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UsageCommitResponse"
                                },
                                "examples": {
                                    "success_with_metrics": {
                                        "summary": "Success with Metrics",
                                        "value": {
                                            "success": true,
                                            "message": "Usage committed as SUCCESS."
                                        }
                                    },
                                    "failed_with_details": {
                                        "summary": "Failed with Details",
                                        "value": {
                                            "success": true,
                                            "message": "Usage committed as FAILED."
                                        }
                                    },
                                    "already_committed": {
                                        "summary": "Already Committed (Idempotent)",
                                        "value": {
                                            "success": true,
                                            "message": "Usage log not found, but operation is idempotent."
                                        }
                                    },
                                    "ownership_mismatch": {
                                        "summary": "Ownership Mismatch",
                                        "value": {
                                            "success": false,
                                            "message": "User does not own this usage log."
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid or missing internal API key or JWT"
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error (e.g., missing failure details when success=False)"
                    }
                }
            }
        },
        "/health": {
            "get": {
                "summary": "Health Check",
                "description": "Health check endpoint to verify if the API is running.\n\nChecks:\n    - Database connectivity\n    - Redis connectivity",
                "operationId": "health_check_health_get",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Bad request error message"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource not found."
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Conflict",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Resource conflict."
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Some internal server error message"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication Error",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Authentication failed."
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Rate Limit Exceeded",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "Rate limit exceeded. Please try again later."
                                }
                            }
                        }
                    },
                    "501": {
                        "description": "Not Implemented",
                        "content": {
                            "application/json": {
                                "example": {
                                    "detail": "This feature is not yet implemented."
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "APIKeyCreate": {
                "properties": {
                    "name": {
                        "type": "string",
                        "maxLength": 128,
                        "minLength": 1,
                        "title": "Name",
                        "description": "User-defined label for the API key"
                    },
                    "expires_in_days": {
                        "type": "integer",
                        "maximum": 365.0,
                        "minimum": 1.0,
                        "title": "Expires In Days",
                        "description": "Number of days until the key expires. Must be between 1 and 365.",
                        "default": 90
                    },
                    "is_test_key": {
                        "type": "boolean",
                        "title": "Is Test Key",
                        "description": "Whether this is a test key. Test keys use cbx_test_ prefix and don't consume credits.",
                        "default": false
                    }
                },
                "type": "object",
                "required": [
                    "name"
                ],
                "title": "APIKeyCreate",
                "description": "Schema for creating an API key.",
                "example": {
                    "expires_in_days": 90,
                    "is_test_key": false,
                    "name": "Production API Key"
                }
            },
            "APIKeyCreatedResponse": {
                "properties": {
                    "api_key": {
                        "type": "string",
                        "title": "Api Key",
                        "description": "The full API key. Store securely - shown only once!"
                    },
                    "key": {
                        "$ref": "#/components/schemas/APIKeyResponse"
                    },
                    "message": {
                        "type": "string",
                        "title": "Message",
                        "default": "Store this API key securely. It will not be shown again."
                    }
                },
                "type": "object",
                "required": [
                    "api_key",
                    "key"
                ],
                "title": "APIKeyCreatedResponse",
                "description": "Schema for newly created API key (includes the full key once).",
                "example": {
                    "api_key": "cbx_live_abc123def456ghi789jkl012mno345pqr678stu901",
                    "key": {
                        "created_at": "2024-01-15T10:30:00Z",
                        "expires_at": "2024-04-15T10:30:00Z",
                        "id": "550e8400-e29b-41d4-a716-446655440000",
                        "is_active": true,
                        "key_prefix": "cbx_live_abc12",
                        "name": "Production API Key"
                    },
                    "message": "Store this API key securely. It will not be shown again."
                }
            },
            "APIKeyListResponse": {
                "properties": {
                    "api_keys": {
                        "items": {
                            "$ref": "#/components/schemas/APIKeyResponse"
                        },
                        "type": "array",
                        "title": "Api Keys"
                    }
                },
                "type": "object",
                "required": [
                    "api_keys"
                ],
                "title": "APIKeyListResponse",
                "description": "Schema for list of API keys.",
                "example": {
                    "api_keys": [
                        {
                            "created_at": "2024-01-15T10:30:00Z",
                            "expires_at": "2024-04-15T10:30:00Z",
                            "id": "550e8400-e29b-41d4-a716-446655440000",
                            "is_active": true,
                            "key_prefix": "cbx_live_abc12",
                            "last_used_at": "2024-02-01T15:45:00Z",
                            "name": "Production API Key"
                        }
                    ]
                }
            },
            "APIKeyResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "name": {
                        "type": "string",
                        "title": "Name"
                    },
                    "key_prefix": {
                        "type": "string",
                        "title": "Key Prefix"
                    },
                    "is_active": {
                        "type": "boolean",
                        "title": "Is Active"
                    },
                    "is_test_key": {
                        "type": "boolean",
                        "title": "Is Test Key"
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Created At"
                    },
                    "expires_at": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Expires At"
                    },
                    "last_used_at": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Last Used At"
                    },
                    "revoked_at": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Revoked At"
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "name",
                    "key_prefix",
                    "is_active",
                    "is_test_key",
                    "created_at",
                    "expires_at",
                    "last_used_at",
                    "revoked_at"
                ],
                "title": "APIKeyResponse",
                "description": "Schema for API key response (without the actual key).",
                "example": {
                    "created_at": "2024-01-15T10:30:00Z",
                    "expires_at": "2024-04-15T10:30:00Z",
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "is_active": true,
                    "is_test_key": false,
                    "key_prefix": "cbx_live_abc12",
                    "last_used_at": "2024-02-01T15:45:00Z",
                    "name": "Production API Key"
                }
            },
            "AccessStatus": {
                "type": "string",
                "enum": [
                    "granted",
                    "denied"
                ],
                "title": "AccessStatus",
                "description": "Status of API usage access validation."
            },
            "AccessTokenResponse": {
                "properties": {
                    "access_token": {
                        "type": "string",
                        "title": "Access Token",
                        "description": "New short-lived JWT access token"
                    },
                    "token_type": {
                        "type": "string",
                        "const": "bearer",
                        "title": "Token Type",
                        "default": "bearer"
                    },
                    "expires_in": {
                        "type": "integer",
                        "title": "Expires In",
                        "description": "Access token expiration time in seconds"
                    }
                },
                "type": "object",
                "required": [
                    "access_token",
                    "expires_in"
                ],
                "title": "AccessTokenResponse",
                "description": "Response schema for refreshed access token.",
                "example": {
                    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                    "expires_in": 900,
                    "token_type": "bearer"
                }
            },
            "ActiveSessionResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "device_info": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Device Info"
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Created At"
                    },
                    "expires_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Expires At"
                    },
                    "is_current": {
                        "type": "boolean",
                        "title": "Is Current",
                        "description": "Whether this is the current session"
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "device_info",
                    "created_at",
                    "expires_at",
                    "is_current"
                ],
                "title": "ActiveSessionResponse",
                "description": "Response schema for an active session.",
                "example": {
                    "created_at": "2024-01-15T10:30:00Z",
                    "device_info": "Chrome on Windows",
                    "expires_at": "2024-01-22T10:30:00Z",
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "is_current": true
                }
            },
            "ActiveSessionsResponse": {
                "properties": {
                    "sessions": {
                        "items": {
                            "$ref": "#/components/schemas/ActiveSessionResponse"
                        },
                        "type": "array",
                        "title": "Sessions"
                    },
                    "total": {
                        "type": "integer",
                        "title": "Total"
                    }
                },
                "type": "object",
                "required": [
                    "sessions",
                    "total"
                ],
                "title": "ActiveSessionsResponse",
                "description": "Response schema for listing active sessions.",
                "example": {
                    "sessions": [
                        {
                            "created_at": "2024-01-15T10:30:00Z",
                            "device_info": "Chrome on Windows",
                            "expires_at": "2024-01-22T10:30:00Z",
                            "id": "550e8400-e29b-41d4-a716-446655440000",
                            "is_current": true
                        }
                    ],
                    "total": 1
                }
            },
            "CancelSubscriptionRequest": {
                "properties": {
                    "cancel_at_period_end": {
                        "type": "boolean",
                        "title": "Cancel At Period End",
                        "default": true
                    }
                },
                "type": "object",
                "title": "CancelSubscriptionRequest",
                "description": "Schema for canceling subscription.",
                "example": {
                    "cancel_at_period_end": true
                }
            },
            "CareerCancelRequest": {
                "properties": {
                    "cancel_at_period_end": {
                        "type": "boolean",
                        "title": "Cancel At Period End",
                        "default": true
                    }
                },
                "type": "object",
                "title": "CareerCancelRequest",
                "description": "Schema for canceling Career subscription.",
                "example": {
                    "cancel_at_period_end": true
                }
            },
            "CareerCheckoutRequest": {
                "properties": {
                    "plan_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Plan Id"
                    },
                    "success_url": {
                        "type": "string",
                        "maxLength": 2083,
                        "minLength": 1,
                        "format": "uri",
                        "title": "Success Url"
                    },
                    "cancel_url": {
                        "type": "string",
                        "maxLength": 2083,
                        "minLength": 1,
                        "format": "uri",
                        "title": "Cancel Url"
                    }
                },
                "type": "object",
                "required": [
                    "plan_id",
                    "success_url",
                    "cancel_url"
                ],
                "title": "CareerCheckoutRequest",
                "description": "Schema for creating a Career checkout session.",
                "example": {
                    "cancel_url": "https://app.cubex.com/career/checkout/cancel",
                    "plan_id": "550e8400-e29b-41d4-a716-446655440000",
                    "success_url": "https://app.cubex.com/career/checkout/success"
                }
            },
            "CareerCheckoutResponse": {
                "properties": {
                    "checkout_url": {
                        "type": "string",
                        "title": "Checkout Url"
                    },
                    "session_id": {
                        "type": "string",
                        "title": "Session Id"
                    }
                },
                "type": "object",
                "required": [
                    "checkout_url",
                    "session_id"
                ],
                "title": "CareerCheckoutResponse",
                "description": "Schema for Career checkout session response.",
                "example": {
                    "checkout_url": "https://checkout.stripe.com/c/pay/cs_test_abc123",
                    "session_id": "cs_test_abc123def456"
                }
            },
            "CareerMessageResponse": {
                "properties": {
                    "message": {
                        "type": "string",
                        "title": "Message"
                    },
                    "success": {
                        "type": "boolean",
                        "title": "Success",
                        "default": true
                    }
                },
                "type": "object",
                "required": [
                    "message"
                ],
                "title": "CareerMessageResponse",
                "description": "Generic message response for Career endpoints.",
                "example": {
                    "message": "Operation completed successfully",
                    "success": true
                }
            },
            "CareerSubscriptionResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "user_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "User Id"
                    },
                    "plan_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Plan Id"
                    },
                    "status": {
                        "$ref": "#/components/schemas/SubscriptionStatus"
                    },
                    "current_period_start": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Current Period Start"
                    },
                    "current_period_end": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Current Period End"
                    },
                    "cancel_at_period_end": {
                        "type": "boolean",
                        "title": "Cancel At Period End"
                    },
                    "canceled_at": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Canceled At"
                    },
                    "plan": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/PlanResponse"
                            },
                            {
                                "type": "null"
                            }
                        ]
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "user_id",
                    "plan_id",
                    "status",
                    "current_period_start",
                    "current_period_end",
                    "cancel_at_period_end",
                    "canceled_at"
                ],
                "title": "CareerSubscriptionResponse",
                "description": "Schema for Career subscription response.",
                "example": {
                    "cancel_at_period_end": false,
                    "current_period_end": "2024-02-15T00:00:00Z",
                    "current_period_start": "2024-01-15T00:00:00Z",
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "plan_id": "550e8400-e29b-41d4-a716-446655440002",
                    "status": "active",
                    "user_id": "550e8400-e29b-41d4-a716-446655440001"
                }
            },
            "CareerUpgradePreviewRequest": {
                "properties": {
                    "new_plan_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "New Plan Id"
                    }
                },
                "type": "object",
                "required": [
                    "new_plan_id"
                ],
                "title": "CareerUpgradePreviewRequest",
                "description": "Schema for requesting a Career upgrade preview.",
                "example": {
                    "new_plan_id": "550e8400-e29b-41d4-a716-446655440000"
                }
            },
            "CareerUpgradePreviewResponse": {
                "properties": {
                    "current_plan": {
                        "type": "string",
                        "title": "Current Plan"
                    },
                    "new_plan": {
                        "type": "string",
                        "title": "New Plan"
                    },
                    "proration_amount": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Proration Amount",
                        "description": "Amount credited/charged for unused time on current plan"
                    },
                    "total_due": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Total Due",
                        "description": "Total amount due immediately upon upgrade"
                    },
                    "currency": {
                        "type": "string",
                        "title": "Currency"
                    },
                    "billing_period_end": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Billing Period End",
                        "description": "When the current billing period ends"
                    }
                },
                "type": "object",
                "required": [
                    "current_plan",
                    "new_plan",
                    "proration_amount",
                    "total_due",
                    "currency",
                    "billing_period_end"
                ],
                "title": "CareerUpgradePreviewResponse",
                "description": "Schema for Career upgrade preview response with proration details.",
                "example": {
                    "billing_period_end": "2024-02-15T00:00:00Z",
                    "currency": "usd",
                    "current_plan": "Plus",
                    "new_plan": "Pro",
                    "proration_amount": "10.00",
                    "total_due": "19.99"
                }
            },
            "CareerUpgradeRequest": {
                "properties": {
                    "new_plan_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "New Plan Id"
                    }
                },
                "type": "object",
                "required": [
                    "new_plan_id"
                ],
                "title": "CareerUpgradeRequest",
                "description": "Schema for upgrading to a new Career plan.",
                "example": {
                    "new_plan_id": "550e8400-e29b-41d4-a716-446655440000"
                }
            },
            "ChangePasswordRequest": {
                "properties": {
                    "current_password": {
                        "type": "string",
                        "title": "Current Password",
                        "description": "Current password"
                    },
                    "new_password": {
                        "type": "string",
                        "maxLength": 128,
                        "minLength": 8,
                        "title": "New Password",
                        "description": "Password (min 8 characters)"
                    }
                },
                "type": "object",
                "required": [
                    "current_password",
                    "new_password"
                ],
                "title": "ChangePasswordRequest",
                "description": "Request schema for changing password (authenticated user).",
                "example": {
                    "current_password": "OldSecurePass123",
                    "new_password": "NewSecurePass456"
                }
            },
            "CheckoutRequest": {
                "properties": {
                    "plan_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Plan Id"
                    },
                    "seat_count": {
                        "type": "integer",
                        "maximum": 100.0,
                        "minimum": 1.0,
                        "title": "Seat Count",
                        "description": "Number of seats"
                    },
                    "success_url": {
                        "type": "string",
                        "maxLength": 2083,
                        "minLength": 1,
                        "format": "uri",
                        "title": "Success Url"
                    },
                    "cancel_url": {
                        "type": "string",
                        "maxLength": 2083,
                        "minLength": 1,
                        "format": "uri",
                        "title": "Cancel Url"
                    }
                },
                "type": "object",
                "required": [
                    "plan_id",
                    "seat_count",
                    "success_url",
                    "cancel_url"
                ],
                "title": "CheckoutRequest",
                "description": "Schema for creating a checkout session.",
                "example": {
                    "cancel_url": "https://app.cubex.com/checkout/cancel",
                    "plan_id": "550e8400-e29b-41d4-a716-446655440000",
                    "seat_count": 5,
                    "success_url": "https://app.cubex.com/checkout/success"
                }
            },
            "CheckoutResponse": {
                "properties": {
                    "checkout_url": {
                        "type": "string",
                        "title": "Checkout Url"
                    },
                    "session_id": {
                        "type": "string",
                        "title": "Session Id"
                    }
                },
                "type": "object",
                "required": [
                    "checkout_url",
                    "session_id"
                ],
                "title": "CheckoutResponse",
                "description": "Schema for checkout session response.",
                "example": {
                    "checkout_url": "https://checkout.stripe.com/c/pay/cs_test_abc123",
                    "session_id": "cs_test_abc123def456"
                }
            },
            "ClientInfo": {
                "properties": {
                    "ip": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Ip",
                        "description": "Client IP address"
                    },
                    "user_agent": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "User Agent",
                        "description": "Client user agent string"
                    }
                },
                "type": "object",
                "title": "ClientInfo",
                "description": "Schema for client information in usage validation."
            },
            "CloudinaryUploadCredentials": {
                "properties": {
                    "upload_url": {
                        "type": "string",
                        "title": "Upload Url"
                    },
                    "api_key": {
                        "type": "string",
                        "title": "Api Key"
                    },
                    "timestamp": {
                        "type": "integer",
                        "title": "Timestamp"
                    },
                    "signature": {
                        "type": "string",
                        "title": "Signature"
                    },
                    "cloud_name": {
                        "type": "string",
                        "title": "Cloud Name"
                    },
                    "folder": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Folder"
                    },
                    "resource_type": {
                        "type": "string",
                        "title": "Resource Type",
                        "default": "auto"
                    },
                    "upload_preset": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Upload Preset"
                    },
                    "eager": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Eager"
                    }
                },
                "additionalProperties": true,
                "type": "object",
                "required": [
                    "upload_url",
                    "api_key",
                    "timestamp",
                    "signature",
                    "cloud_name"
                ],
                "title": "CloudinaryUploadCredentials",
                "description": "Pydantic model representing the credentials needed for secure client-side uploads to Cloudinary."
            },
            "ContactSalesRequest": {
                "properties": {
                    "first_name": {
                        "type": "string",
                        "maxLength": 255,
                        "minLength": 1,
                        "title": "First Name",
                        "description": "First name of the requester"
                    },
                    "last_name": {
                        "type": "string",
                        "maxLength": 255,
                        "minLength": 1,
                        "title": "Last Name",
                        "description": "Last name of the requester"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "Email address for follow-up contact"
                    },
                    "message": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 5000
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Message",
                        "description": "Optional message with details about the inquiry"
                    }
                },
                "type": "object",
                "required": [
                    "first_name",
                    "last_name",
                    "email"
                ],
                "title": "ContactSalesRequest",
                "description": "Request schema for contact-sales endpoint.",
                "example": {
                    "email": "john.doe@example.com",
                    "first_name": "John",
                    "last_name": "Doe",
                    "message": "I'm interested in enterprise pricing for my team."
                }
            },
            "ContactSalesResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id",
                        "description": "Unique identifier for the sales request"
                    },
                    "message": {
                        "type": "string",
                        "title": "Message",
                        "description": "Confirmation message"
                    },
                    "status": {
                        "$ref": "#/components/schemas/SalesRequestStatus",
                        "description": "Current status of the request"
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "message",
                    "status"
                ],
                "title": "ContactSalesResponse",
                "description": "Response schema for contact-sales endpoint.",
                "example": {
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "message": "Thank you for your inquiry. Our sales team will contact you shortly.",
                    "status": "pending"
                }
            },
            "FailureDetails": {
                "properties": {
                    "failure_type": {
                        "$ref": "#/components/schemas/FailureType",
                        "description": "Category of the failure"
                    },
                    "reason": {
                        "type": "string",
                        "maxLength": 1000,
                        "minLength": 1,
                        "title": "Reason",
                        "description": "Human-readable failure description"
                    }
                },
                "type": "object",
                "required": [
                    "failure_type",
                    "reason"
                ],
                "title": "FailureDetails",
                "description": "Schema for failure details when committing failed requests.",
                "example": {
                    "failure_type": "internal_error",
                    "reason": "Model API returned 500 Internal Server Error"
                }
            },
            "FailureType": {
                "type": "string",
                "enum": [
                    "internal_error",
                    "timeout",
                    "rate_limited",
                    "invalid_response",
                    "upstream_error",
                    "client_error",
                    "validation_error"
                ],
                "title": "FailureType",
                "description": "Type of failure for API usage tracking.\n\nUsed to categorize failures when committing usage logs with success=False.\nHelps identify patterns and issues we may be responsible for."
            },
            "FeatureKey": {
                "type": "string",
                "enum": [
                    "api.career_path",
                    "api.extract_keywords",
                    "api.feedback_analyzer",
                    "api.generate_feedback",
                    "api.job_match",
                    "api.extract_cues.resume",
                    "api.extract_cues.feedback",
                    "api.extract_cues.interview",
                    "api.extract_cues.assessment",
                    "api.reframe_feedback",
                    "career.career_path",
                    "career.extract_keywords",
                    "career.feedback_analyzer",
                    "career.generate_feedback",
                    "career.job_match",
                    "career.extract_cues.resume",
                    "career.extract_cues.feedback",
                    "career.extract_cues.interview",
                    "career.extract_cues.assessment",
                    "career.reframe_feedback"
                ],
                "title": "FeatureKey"
            },
            "FeatureResponse": {
                "properties": {
                    "title": {
                        "type": "string",
                        "title": "Title"
                    },
                    "description": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Description"
                    },
                    "value": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "boolean"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Value"
                    },
                    "category": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Category"
                    }
                },
                "type": "object",
                "required": [
                    "title"
                ],
                "title": "FeatureResponse",
                "description": "Schema for plan feature.",
                "example": {
                    "category": "limits",
                    "description": "Number of API calls per minute",
                    "title": "API Rate Limit",
                    "value": "1000"
                }
            },
            "HTTPValidationError": {
                "properties": {
                    "detail": {
                        "items": {
                            "$ref": "#/components/schemas/ValidationError"
                        },
                        "type": "array",
                        "title": "Detail"
                    }
                },
                "type": "object",
                "title": "HTTPValidationError"
            },
            "InvitationAccept": {
                "properties": {
                    "token": {
                        "type": "string",
                        "title": "Token"
                    }
                },
                "type": "object",
                "required": [
                    "token"
                ],
                "title": "InvitationAccept",
                "description": "Schema for accepting an invitation.",
                "example": {
                    "token": "abc123def456ghi789jkl012mno345pqr678"
                }
            },
            "InvitationCreate": {
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "Email address to invite"
                    },
                    "role": {
                        "$ref": "#/components/schemas/MemberRole",
                        "description": "Role to assign: admin or member",
                        "default": "member"
                    },
                    "callback_url": {
                        "type": "string",
                        "title": "Callback Url",
                        "description": "Frontend URL where user will be redirected to accept invite. Token will be appended as query param. Must be in allowed CORS origins."
                    }
                },
                "type": "object",
                "required": [
                    "email",
                    "callback_url"
                ],
                "title": "InvitationCreate",
                "description": "Schema for creating an invitation.",
                "example": {
                    "callback_url": "https://app.example.com/invites/accept",
                    "email": "newmember@example.com",
                    "role": "member"
                }
            },
            "InvitationCreatedResponse": {
                "properties": {
                    "invitation": {
                        "$ref": "#/components/schemas/InvitationResponse"
                    },
                    "invitation_url": {
                        "type": "string",
                        "title": "Invitation Url"
                    }
                },
                "type": "object",
                "required": [
                    "invitation",
                    "invitation_url"
                ],
                "title": "InvitationCreatedResponse",
                "description": "Schema for invitation created response.",
                "example": {
                    "invitation": {
                        "created_at": "2024-01-15T10:30:00Z",
                        "email": "newmember@example.com",
                        "expires_at": "2024-01-22T10:30:00Z",
                        "id": "550e8400-e29b-41d4-a716-446655440000",
                        "inviter_email": "admin@example.com",
                        "role": "member",
                        "status": "pending"
                    },
                    "invitation_url": "https://app.cubex.com/invite/abc123def456"
                }
            },
            "InvitationListResponse": {
                "properties": {
                    "invitations": {
                        "items": {
                            "$ref": "#/components/schemas/InvitationResponse"
                        },
                        "type": "array",
                        "title": "Invitations"
                    }
                },
                "type": "object",
                "required": [
                    "invitations"
                ],
                "title": "InvitationListResponse",
                "description": "Schema for list of invitations.",
                "example": {
                    "invitations": [
                        {
                            "created_at": "2024-01-15T10:30:00Z",
                            "email": "newmember@example.com",
                            "expires_at": "2024-01-22T10:30:00Z",
                            "id": "550e8400-e29b-41d4-a716-446655440000",
                            "inviter_email": "admin@example.com",
                            "role": "member",
                            "status": "pending"
                        }
                    ]
                }
            },
            "InvitationResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "email": {
                        "type": "string",
                        "title": "Email"
                    },
                    "role": {
                        "$ref": "#/components/schemas/MemberRole"
                    },
                    "status": {
                        "$ref": "#/components/schemas/InvitationStatus"
                    },
                    "expires_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Expires At"
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Created At"
                    },
                    "inviter_email": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Inviter Email"
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "email",
                    "role",
                    "status",
                    "expires_at",
                    "created_at"
                ],
                "title": "InvitationResponse",
                "description": "Schema for invitation response.",
                "example": {
                    "created_at": "2024-01-15T10:30:00Z",
                    "email": "newmember@example.com",
                    "expires_at": "2024-01-22T10:30:00Z",
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "inviter_email": "admin@example.com",
                    "role": "member",
                    "status": "pending"
                }
            },
            "InvitationStatus": {
                "type": "string",
                "enum": [
                    "pending",
                    "accepted",
                    "expired",
                    "revoked"
                ],
                "title": "InvitationStatus",
                "description": "Status of a workspace invitation."
            },
            "LoginRequest": {
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "User's email address"
                    },
                    "password": {
                        "type": "string",
                        "title": "Password",
                        "description": "User's password"
                    },
                    "remember_me": {
                        "type": "boolean",
                        "title": "Remember Me",
                        "description": "If true, extends refresh token duration to 30 days",
                        "default": false
                    }
                },
                "type": "object",
                "required": [
                    "email",
                    "password"
                ],
                "title": "LoginRequest",
                "description": "Request schema for email signin.",
                "example": {
                    "email": "user@example.com",
                    "password": "SecurePass123",
                    "remember_me": false
                }
            },
            "MemberRole": {
                "type": "string",
                "enum": [
                    "owner",
                    "admin",
                    "member"
                ],
                "title": "MemberRole",
                "description": "Role of a workspace member."
            },
            "MemberRoleUpdate": {
                "properties": {
                    "role": {
                        "$ref": "#/components/schemas/MemberRole",
                        "description": "New member role: admin or member"
                    }
                },
                "type": "object",
                "required": [
                    "role"
                ],
                "title": "MemberRoleUpdate",
                "description": "Schema for updating member role.",
                "example": {
                    "role": "admin"
                }
            },
            "MemberStatus": {
                "type": "string",
                "enum": [
                    "enabled",
                    "disabled"
                ],
                "title": "MemberStatus",
                "description": "Status of a workspace member."
            },
            "MemberStatusUpdate": {
                "properties": {
                    "status": {
                        "$ref": "#/components/schemas/MemberStatus",
                        "description": "New member status: enabled or disabled"
                    }
                },
                "type": "object",
                "required": [
                    "status"
                ],
                "title": "MemberStatusUpdate",
                "description": "Schema for updating member status.",
                "example": {
                    "status": "disabled"
                }
            },
            "MessageResponse": {
                "properties": {
                    "message": {
                        "type": "string",
                        "title": "Message"
                    },
                    "success": {
                        "type": "boolean",
                        "title": "Success",
                        "default": true
                    }
                },
                "type": "object",
                "required": [
                    "message"
                ],
                "title": "MessageResponse",
                "description": "Generic message response.",
                "example": {
                    "message": "Operation completed successfully",
                    "success": true
                }
            },
            "OAuthInitResponse": {
                "properties": {
                    "authorization_url": {
                        "type": "string",
                        "title": "Authorization Url",
                        "description": "URL to redirect user for OAuth consent"
                    },
                    "state": {
                        "type": "string",
                        "title": "State",
                        "description": "CSRF protection state parameter"
                    }
                },
                "type": "object",
                "required": [
                    "authorization_url",
                    "state"
                ],
                "title": "OAuthInitResponse",
                "description": "Response schema for OAuth initialization.",
                "example": {
                    "authorization_url": "https://accounts.google.com/o/oauth2/auth?...",
                    "state": "abc123xyz789"
                }
            },
            "OAuthProviders": {
                "type": "string",
                "enum": [
                    "google",
                    "github"
                ],
                "title": "OAuthProviders",
                "description": "Supported OAuth providers for authentication."
            },
            "OTPVerifyRequest": {
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "Email the OTP was sent to"
                    },
                    "otp_code": {
                        "type": "string",
                        "maxLength": 6,
                        "minLength": 6,
                        "pattern": "^\\d{6}$",
                        "title": "Otp Code",
                        "description": "6-digit verification code"
                    }
                },
                "type": "object",
                "required": [
                    "email",
                    "otp_code"
                ],
                "title": "OTPVerifyRequest",
                "description": "Request schema for OTP verification.",
                "example": {
                    "email": "user@example.com",
                    "otp_code": "123456"
                }
            },
            "PasswordResetConfirmRequest": {
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "Email address"
                    },
                    "otp_code": {
                        "type": "string",
                        "maxLength": 6,
                        "minLength": 6,
                        "pattern": "^\\d{6}$",
                        "title": "Otp Code",
                        "description": "6-digit verification code"
                    },
                    "new_password": {
                        "type": "string",
                        "maxLength": 128,
                        "minLength": 8,
                        "title": "New Password",
                        "description": "Password (min 8 characters)"
                    }
                },
                "type": "object",
                "required": [
                    "email",
                    "otp_code",
                    "new_password"
                ],
                "title": "PasswordResetConfirmRequest",
                "description": "Request schema for confirming password reset with OTP.",
                "example": {
                    "email": "user@example.com",
                    "new_password": "NewSecurePass123",
                    "otp_code": "123456"
                }
            },
            "PasswordResetRequest": {
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "Email address for password reset"
                    }
                },
                "type": "object",
                "required": [
                    "email"
                ],
                "title": "PasswordResetRequest",
                "description": "Request schema for initiating password reset.",
                "example": {
                    "email": "user@example.com"
                }
            },
            "PlanListResponse": {
                "properties": {
                    "plans": {
                        "items": {
                            "$ref": "#/components/schemas/PlanResponse"
                        },
                        "type": "array",
                        "title": "Plans"
                    }
                },
                "type": "object",
                "required": [
                    "plans"
                ],
                "title": "PlanListResponse",
                "description": "Schema for list of plans.",
                "example": {
                    "plans": [
                        {
                            "description": "Professional plan",
                            "display_price": "$29.99/month",
                            "features": [],
                            "id": "550e8400-e29b-41d4-a716-446655440000",
                            "is_active": true,
                            "max_seats": 50,
                            "min_seats": 1,
                            "name": "pro",
                            "price": "29.99",
                            "seat_display_price": "$5/seat/month",
                            "seat_price": "5.00",
                            "trial_days": 14,
                            "type": "paid"
                        }
                    ]
                }
            },
            "PlanResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "name": {
                        "type": "string",
                        "title": "Name"
                    },
                    "description": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Description"
                    },
                    "price": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Price"
                    },
                    "display_price": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Display Price"
                    },
                    "seat_price": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Seat Price"
                    },
                    "seat_display_price": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Seat Display Price"
                    },
                    "is_active": {
                        "type": "boolean",
                        "title": "Is Active"
                    },
                    "trial_days": {
                        "anyOf": [
                            {
                                "type": "integer"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Trial Days"
                    },
                    "type": {
                        "$ref": "#/components/schemas/PlanType"
                    },
                    "features": {
                        "items": {
                            "$ref": "#/components/schemas/FeatureResponse"
                        },
                        "type": "array",
                        "title": "Features",
                        "default": []
                    },
                    "max_seats": {
                        "anyOf": [
                            {
                                "type": "integer"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Max Seats"
                    },
                    "min_seats": {
                        "type": "integer",
                        "title": "Min Seats"
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "name",
                    "description",
                    "price",
                    "display_price",
                    "seat_price",
                    "seat_display_price",
                    "is_active",
                    "trial_days",
                    "type",
                    "max_seats",
                    "min_seats"
                ],
                "title": "PlanResponse",
                "description": "Schema for plan response.",
                "example": {
                    "description": "Professional plan with advanced features",
                    "display_price": "$29.99/month",
                    "features": [
                        {
                            "category": "limits",
                            "description": "Number of API calls per minute",
                            "title": "API Rate Limit",
                            "value": "1000"
                        }
                    ],
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "is_active": true,
                    "max_seats": 50,
                    "min_seats": 1,
                    "name": "pro",
                    "price": "29.99",
                    "seat_display_price": "$5/seat/month",
                    "seat_price": "5.00",
                    "trial_days": 14,
                    "type": "paid"
                }
            },
            "PlanType": {
                "type": "string",
                "enum": [
                    "free",
                    "paid"
                ],
                "title": "PlanType",
                "description": "Type of subscription plan."
            },
            "ProfileResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email"
                    },
                    "email_verified": {
                        "type": "boolean",
                        "title": "Email Verified"
                    },
                    "full_name": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Full Name"
                    },
                    "avatar_url": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Avatar Url"
                    },
                    "is_active": {
                        "type": "boolean",
                        "title": "Is Active"
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Created At"
                    },
                    "updated_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Updated At"
                    },
                    "has_password": {
                        "type": "boolean",
                        "title": "Has Password",
                        "description": "Whether user has a password set (false for OAuth-only)"
                    },
                    "oauth_providers": {
                        "items": {
                            "$ref": "#/components/schemas/OAuthProviders"
                        },
                        "type": "array",
                        "title": "Oauth Providers",
                        "description": "List of linked OAuth providers"
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "email",
                    "email_verified",
                    "full_name",
                    "avatar_url",
                    "is_active",
                    "created_at",
                    "updated_at",
                    "has_password"
                ],
                "title": "ProfileResponse",
                "description": "Response schema for user profile.",
                "example": {
                    "avatar_url": "https://example.com/avatar.jpg",
                    "created_at": "2024-01-15T10:30:00Z",
                    "email": "user@example.com",
                    "email_verified": true,
                    "full_name": "John Doe",
                    "has_password": true,
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "is_active": true,
                    "oauth_providers": [
                        "google"
                    ],
                    "updated_at": "2024-01-20T15:45:00Z"
                }
            },
            "ProfileUpdateRequest": {
                "properties": {
                    "full_name": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 255,
                                "minLength": 1
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Full Name",
                        "description": "User's full name"
                    },
                    "avatar_url": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 512
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Avatar Url",
                        "description": "URL to user's avatar image"
                    }
                },
                "type": "object",
                "title": "ProfileUpdateRequest",
                "description": "Request schema for updating user profile.",
                "example": {
                    "avatar_url": "https://example.com/new-avatar.jpg",
                    "full_name": "Jane Doe"
                }
            },
            "ReactivateRequest": {
                "properties": {
                    "member_ids_to_enable": {
                        "anyOf": [
                            {
                                "items": {
                                    "type": "string",
                                    "format": "uuid"
                                },
                                "type": "array"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Member Ids To Enable"
                    }
                },
                "type": "object",
                "title": "ReactivateRequest",
                "description": "Schema for reactivating a frozen workspace.",
                "example": {
                    "member_ids_to_enable": [
                        "550e8400-e29b-41d4-a716-446655440000",
                        "550e8400-e29b-41d4-a716-446655440001"
                    ]
                }
            },
            "RefreshTokenRequest": {
                "properties": {
                    "refresh_token": {
                        "type": "string",
                        "title": "Refresh Token",
                        "description": "The refresh token to use"
                    }
                },
                "type": "object",
                "required": [
                    "refresh_token"
                ],
                "title": "RefreshTokenRequest",
                "description": "Request schema for token refresh.",
                "example": {
                    "refresh_token": "dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4..."
                }
            },
            "ResendOTPRequest": {
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "Email to resend OTP to"
                    }
                },
                "type": "object",
                "required": [
                    "email"
                ],
                "title": "ResendOTPRequest",
                "description": "Request schema for resending OTP.",
                "example": {
                    "email": "user@example.com"
                }
            },
            "SalesRequestStatus": {
                "type": "string",
                "enum": [
                    "pending",
                    "contacted",
                    "closed"
                ],
                "title": "SalesRequestStatus",
                "description": "Status of a sales request."
            },
            "SeatUpdateRequest": {
                "properties": {
                    "seat_count": {
                        "type": "integer",
                        "maximum": 100.0,
                        "minimum": 1.0,
                        "title": "Seat Count",
                        "description": "New seat count"
                    }
                },
                "type": "object",
                "required": [
                    "seat_count"
                ],
                "title": "SeatUpdateRequest",
                "description": "Schema for updating seat count.",
                "example": {
                    "seat_count": 10
                }
            },
            "SignupRequest": {
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email",
                        "description": "User's email address"
                    },
                    "password": {
                        "type": "string",
                        "maxLength": 128,
                        "minLength": 8,
                        "title": "Password",
                        "description": "Password (min 8 characters)"
                    },
                    "full_name": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 255,
                                "minLength": 1
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Full Name",
                        "description": "User's full name"
                    }
                },
                "type": "object",
                "required": [
                    "email",
                    "password"
                ],
                "title": "SignupRequest",
                "description": "Request schema for email signup.",
                "example": {
                    "email": "user@example.com",
                    "full_name": "John Doe",
                    "password": "SecurePass123"
                }
            },
            "SignupResponse": {
                "properties": {
                    "message": {
                        "type": "string",
                        "title": "Message",
                        "default": "Verification code sent to your email"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "title": "Email"
                    },
                    "requires_verification": {
                        "type": "boolean",
                        "title": "Requires Verification",
                        "default": true
                    }
                },
                "type": "object",
                "required": [
                    "email"
                ],
                "title": "SignupResponse",
                "description": "Response schema for successful signup (pending verification).",
                "example": {
                    "email": "user@example.com",
                    "message": "Verification code sent to your email",
                    "requires_verification": true
                }
            },
            "SubscriptionResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "workspace_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Workspace Id"
                    },
                    "plan_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Plan Id"
                    },
                    "status": {
                        "$ref": "#/components/schemas/SubscriptionStatus"
                    },
                    "seat_count": {
                        "type": "integer",
                        "title": "Seat Count"
                    },
                    "current_period_start": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Current Period Start"
                    },
                    "current_period_end": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Current Period End"
                    },
                    "cancel_at_period_end": {
                        "type": "boolean",
                        "title": "Cancel At Period End"
                    },
                    "canceled_at": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Canceled At"
                    },
                    "credits_allocation": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Allocation",
                        "description": "Total credits allocated for the billing period"
                    },
                    "credits_used": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Used",
                        "description": "Credits used in the current billing period"
                    },
                    "plan": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/PlanResponse"
                            },
                            {
                                "type": "null"
                            }
                        ]
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "workspace_id",
                    "plan_id",
                    "status",
                    "seat_count",
                    "current_period_start",
                    "current_period_end",
                    "cancel_at_period_end",
                    "canceled_at",
                    "credits_allocation",
                    "credits_used"
                ],
                "title": "SubscriptionResponse",
                "description": "Schema for subscription response.",
                "example": {
                    "cancel_at_period_end": false,
                    "credits_allocation": "5000.00",
                    "credits_used": "1250.50",
                    "current_period_end": "2024-02-15T00:00:00Z",
                    "current_period_start": "2024-01-15T00:00:00Z",
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "plan_id": "550e8400-e29b-41d4-a716-446655440002",
                    "seat_count": 5,
                    "status": "active",
                    "workspace_id": "550e8400-e29b-41d4-a716-446655440001"
                }
            },
            "SubscriptionStatus": {
                "type": "string",
                "enum": [
                    "active",
                    "past_due",
                    "canceled",
                    "incomplete",
                    "incomplete_expired",
                    "trialing",
                    "unpaid",
                    "paused"
                ],
                "title": "SubscriptionStatus",
                "description": "Status of a subscription."
            },
            "TokenResponse": {
                "properties": {
                    "access_token": {
                        "type": "string",
                        "title": "Access Token",
                        "description": "Short-lived JWT access token"
                    },
                    "refresh_token": {
                        "type": "string",
                        "title": "Refresh Token",
                        "description": "Long-lived refresh token"
                    },
                    "token_type": {
                        "type": "string",
                        "const": "bearer",
                        "title": "Token Type",
                        "default": "bearer"
                    },
                    "expires_in": {
                        "type": "integer",
                        "title": "Expires In",
                        "description": "Access token expiration time in seconds"
                    }
                },
                "type": "object",
                "required": [
                    "access_token",
                    "refresh_token",
                    "expires_in"
                ],
                "title": "TokenResponse",
                "description": "Response schema for successful authentication.",
                "example": {
                    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                    "expires_in": 900,
                    "refresh_token": "dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4...",
                    "token_type": "bearer"
                }
            },
            "UpgradePreviewRequest": {
                "properties": {
                    "new_plan_id": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "uuid"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "New Plan Id"
                    },
                    "new_seat_count": {
                        "anyOf": [
                            {
                                "type": "integer",
                                "maximum": 100.0,
                                "minimum": 1.0,
                                "description": "New seat count"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "New Seat Count"
                    }
                },
                "type": "object",
                "title": "UpgradePreviewRequest",
                "description": "Schema for requesting an upgrade preview.",
                "example": {
                    "new_plan_id": "550e8400-e29b-41d4-a716-446655440000",
                    "new_seat_count": 10
                }
            },
            "UpgradePreviewResponse": {
                "properties": {
                    "current_plan": {
                        "type": "string",
                        "title": "Current Plan"
                    },
                    "new_plan": {
                        "type": "string",
                        "title": "New Plan"
                    },
                    "current_seat_count": {
                        "type": "integer",
                        "title": "Current Seat Count"
                    },
                    "new_seat_count": {
                        "type": "integer",
                        "title": "New Seat Count"
                    },
                    "proration_amount": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Proration Amount",
                        "description": "Amount credited/charged for unused time on current plan"
                    },
                    "total_due": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Total Due",
                        "description": "Total amount due immediately upon upgrade"
                    },
                    "currency": {
                        "type": "string",
                        "title": "Currency"
                    },
                    "billing_period_end": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "date-time"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Billing Period End",
                        "description": "When the current billing period ends"
                    }
                },
                "type": "object",
                "required": [
                    "current_plan",
                    "new_plan",
                    "current_seat_count",
                    "new_seat_count",
                    "proration_amount",
                    "total_due",
                    "currency",
                    "billing_period_end"
                ],
                "title": "UpgradePreviewResponse",
                "description": "Schema for upgrade preview response with proration details.",
                "example": {
                    "billing_period_end": "2024-02-15T00:00:00Z",
                    "currency": "usd",
                    "current_plan": "Basic",
                    "current_seat_count": 5,
                    "new_plan": "Professional",
                    "new_seat_count": 10,
                    "proration_amount": "15.50",
                    "total_due": "29.99"
                }
            },
            "UpgradeRequest": {
                "properties": {
                    "new_plan_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "New Plan Id"
                    }
                },
                "type": "object",
                "required": [
                    "new_plan_id"
                ],
                "title": "UpgradeRequest",
                "description": "Schema for upgrading to a new plan.",
                "example": {
                    "new_plan_id": "550e8400-e29b-41d4-a716-446655440000"
                }
            },
            "UsageCommitRequest": {
                "properties": {
                    "user_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "User Id",
                        "description": "The ID of the user that made the original request. This value is returned in the `UsageValidateResponse`."
                    },
                    "usage_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Usage Id",
                        "description": "The usage log ID to commit"
                    },
                    "success": {
                        "type": "boolean",
                        "title": "Success",
                        "description": "True if request succeeded, False if failed"
                    },
                    "metrics": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/UsageMetrics"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Optional metrics for successful requests"
                    },
                    "failure": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/FailureDetails"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Required failure details when success=False"
                    }
                },
                "type": "object",
                "required": [
                    "user_id",
                    "usage_id",
                    "success"
                ],
                "title": "UsageCommitRequest",
                "description": "Schema for committing API usage (internal endpoint).\n\nWhen success=True, optionally provide metrics (model, tokens, latency).\nWhen success=False, failure details are REQUIRED.",
                "example": {
                    "metrics": {
                        "input_tokens": 1500,
                        "latency_ms": 1200,
                        "model_used": "gpt-4o",
                        "output_tokens": 500
                    },
                    "success": true,
                    "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                    "user_id": "550e8400-e29b-41d4-a716-446655440000"
                }
            },
            "UsageCommitResponse": {
                "properties": {
                    "success": {
                        "type": "boolean",
                        "title": "Success"
                    },
                    "message": {
                        "type": "string",
                        "title": "Message"
                    }
                },
                "type": "object",
                "required": [
                    "success",
                    "message"
                ],
                "title": "UsageCommitResponse",
                "description": "Schema for usage commit response.",
                "example": {
                    "message": "Usage committed as SUCCESS.",
                    "success": true
                }
            },
            "UsageEstimate": {
                "properties": {
                    "input_chars": {
                        "anyOf": [
                            {
                                "type": "integer",
                                "maximum": 10000000.0,
                                "minimum": 0.0
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Input Chars",
                        "description": "Number of input characters"
                    },
                    "max_output_tokens": {
                        "anyOf": [
                            {
                                "type": "integer",
                                "maximum": 2000000.0,
                                "minimum": 0.0
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Max Output Tokens",
                        "description": "Maximum output tokens expected"
                    },
                    "model": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 100
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Model",
                        "description": "Model identifier being used"
                    }
                },
                "type": "object",
                "title": "UsageEstimate",
                "description": "Schema for usage estimation in usage validation.\n\nIf provided, at least one field must be set."
            },
            "UsageMetrics": {
                "properties": {
                    "model_used": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 100
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Model Used",
                        "description": "Model identifier used (e.g., 'gpt-4o')"
                    },
                    "input_tokens": {
                        "anyOf": [
                            {
                                "type": "integer",
                                "maximum": 2000000.0,
                                "minimum": 0.0
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Input Tokens",
                        "description": "Actual input tokens used"
                    },
                    "output_tokens": {
                        "anyOf": [
                            {
                                "type": "integer",
                                "maximum": 2000000.0,
                                "minimum": 0.0
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Output Tokens",
                        "description": "Actual output tokens generated"
                    },
                    "latency_ms": {
                        "anyOf": [
                            {
                                "type": "integer",
                                "maximum": 3600000.0,
                                "minimum": 0.0
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Latency Ms",
                        "description": "Request latency in milliseconds (max 1hr)"
                    }
                },
                "type": "object",
                "title": "UsageMetrics",
                "description": "Schema for usage metrics when committing successful requests.",
                "example": {
                    "input_tokens": 1500,
                    "latency_ms": 1200,
                    "model_used": "gpt-4o",
                    "output_tokens": 500
                }
            },
            "UsageValidateRequest": {
                "properties": {
                    "request_id": {
                        "type": "string",
                        "title": "Request Id",
                        "description": "Globally unique request ID for idempotency"
                    },
                    "feature_key": {
                        "$ref": "#/components/schemas/FeatureKey",
                        "description": "The feature key identifying the career feature being used"
                    },
                    "endpoint": {
                        "type": "string",
                        "title": "Endpoint",
                        "description": "The API endpoint path being called"
                    },
                    "method": {
                        "type": "string",
                        "title": "Method",
                        "description": "HTTP method (GET, POST, etc.)"
                    },
                    "payload_hash": {
                        "type": "string",
                        "maxLength": 64,
                        "minLength": 64,
                        "pattern": "^[a-f0-9]{64}$",
                        "title": "Payload Hash",
                        "description": "SHA-256 hash of the request payload for fingerprinting"
                    },
                    "client": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/ClientInfo"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Optional client information"
                    },
                    "usage_estimate": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/UsageEstimate"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Optional usage estimation for the request"
                    }
                },
                "type": "object",
                "required": [
                    "request_id",
                    "feature_key",
                    "endpoint",
                    "method",
                    "payload_hash"
                ],
                "title": "UsageValidateRequest",
                "description": "Schema for validating API usage (internal endpoint).",
                "example": {
                    "client": {
                        "ip": "102.89.1.22",
                        "user_agent": "Mozilla/5.0"
                    },
                    "endpoint": "/v1/extract-cues/resume",
                    "feature_key": "career.career_path",
                    "method": "POST",
                    "payload_hash": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
                    "request_id": "req_9f0c2a7e-acde-4b9a-8b2f-83cc71a3c9a2",
                    "usage_estimate": {
                        "input_chars": 22000,
                        "max_output_tokens": 700,
                        "model": "gpt-4o-mini"
                    }
                }
            },
            "UsageValidateResponse": {
                "properties": {
                    "access": {
                        "$ref": "#/components/schemas/AccessStatus"
                    },
                    "usage_id": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "uuid"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Usage Id"
                    },
                    "message": {
                        "type": "string",
                        "title": "Message"
                    },
                    "credits_reserved": {
                        "anyOf": [
                            {
                                "type": "string",
                                "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Credits Reserved",
                        "description": "The credits reserved/charged for this request"
                    },
                    "is_test_key": {
                        "type": "boolean",
                        "title": "Is Test Key",
                        "description": "Whether this request used a test key. Server B can use this to return mocked responses.",
                        "default": false
                    }
                },
                "type": "object",
                "required": [
                    "access",
                    "usage_id",
                    "message"
                ],
                "title": "UsageValidateResponse",
                "description": "Schema for usage validation response.",
                "example": {
                    "access": "granted",
                    "credits_reserved": "1.5000",
                    "is_test_key": false,
                    "message": "Access granted. 98.50 credits remaining after this request.",
                    "usage_id": "550e8400-e29b-41d4-a716-446655440000"
                }
            },
            "ValidationError": {
                "properties": {
                    "loc": {
                        "items": {
                            "anyOf": [
                                {
                                    "type": "string"
                                },
                                {
                                    "type": "integer"
                                }
                            ]
                        },
                        "type": "array",
                        "title": "Location"
                    },
                    "msg": {
                        "type": "string",
                        "title": "Message"
                    },
                    "type": {
                        "type": "string",
                        "title": "Error Type"
                    }
                },
                "type": "object",
                "required": [
                    "loc",
                    "msg",
                    "type"
                ],
                "title": "ValidationError"
            },
            "WorkspaceCreate": {
                "properties": {
                    "display_name": {
                        "type": "string",
                        "maxLength": 128,
                        "minLength": 1,
                        "title": "Display Name",
                        "description": "Workspace display name"
                    },
                    "description": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 500
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Description",
                        "description": "Workspace description"
                    }
                },
                "type": "object",
                "required": [
                    "display_name"
                ],
                "title": "WorkspaceCreate",
                "description": "Schema for creating a new workspace.",
                "example": {
                    "description": "Workspace for our startup team",
                    "display_name": "My Startup"
                }
            },
            "WorkspaceDetailResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "display_name": {
                        "type": "string",
                        "title": "Display Name"
                    },
                    "slug": {
                        "type": "string",
                        "title": "Slug"
                    },
                    "status": {
                        "$ref": "#/components/schemas/WorkspaceStatus"
                    },
                    "is_personal": {
                        "type": "boolean",
                        "title": "Is Personal"
                    },
                    "description": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Description"
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Created At"
                    },
                    "owner_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Owner Id"
                    },
                    "enabled_member_count": {
                        "type": "integer",
                        "title": "Enabled Member Count",
                        "default": 0
                    },
                    "total_member_count": {
                        "type": "integer",
                        "title": "Total Member Count",
                        "default": 0
                    },
                    "seat_count": {
                        "type": "integer",
                        "title": "Seat Count",
                        "default": 0
                    },
                    "available_seats": {
                        "type": "integer",
                        "title": "Available Seats",
                        "default": 0
                    },
                    "credits_used": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Used",
                        "default": "0.00"
                    },
                    "credits_limit": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Limit",
                        "default": "0.00"
                    },
                    "members": {
                        "items": {
                            "$ref": "#/components/schemas/WorkspaceMemberResponse"
                        },
                        "type": "array",
                        "title": "Members",
                        "default": []
                    },
                    "credits_remaining": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Remaining",
                        "description": "Calculate remaining credits.",
                        "readOnly": true
                    },
                    "client_id": {
                        "type": "string",
                        "title": "Client Id",
                        "description": "Generate client ID from workspace ID (ws_<uuid_hex>).",
                        "readOnly": true
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "display_name",
                    "slug",
                    "status",
                    "is_personal",
                    "description",
                    "created_at",
                    "owner_id",
                    "credits_remaining",
                    "client_id"
                ],
                "title": "WorkspaceDetailResponse",
                "description": "Schema for detailed workspace response with members.",
                "example": {
                    "available_seats": 3,
                    "client_id": "ws_550e8400e29b41d4a716446655440000",
                    "created_at": "2024-01-15T10:30:00Z",
                    "credits_limit": "1000.00",
                    "credits_remaining": "850.00",
                    "credits_used": "150.00",
                    "description": "Workspace for our startup team",
                    "display_name": "My Startup",
                    "enabled_member_count": 5,
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "is_personal": false,
                    "members": [
                        {
                            "id": "550e8400-e29b-41d4-a716-446655440002",
                            "joined_at": "2024-01-15T10:30:00Z",
                            "role": "owner",
                            "status": "enabled",
                            "user_avatar_url": "https://example.com/avatar_owner.jpg",
                            "user_email": "owner@example.com",
                            "user_id": "550e8400-e29b-41d4-a716-446655440001",
                            "user_name": "Owner Name"
                        }
                    ],
                    "owner_id": "550e8400-e29b-41d4-a716-446655440001",
                    "seat_count": 10,
                    "slug": "my-startup",
                    "status": "active",
                    "total_member_count": 7
                }
            },
            "WorkspaceListResponse": {
                "properties": {
                    "workspaces": {
                        "items": {
                            "$ref": "#/components/schemas/WorkspaceResponse"
                        },
                        "type": "array",
                        "title": "Workspaces"
                    }
                },
                "type": "object",
                "required": [
                    "workspaces"
                ],
                "title": "WorkspaceListResponse",
                "description": "Schema for list of workspaces.",
                "example": {
                    "workspaces": [
                        {
                            "available_seats": 3,
                            "client_id": "ws_550e8400e29b41d4a716446655440000",
                            "created_at": "2024-01-15T10:30:00Z",
                            "credits_limit": "1000.00",
                            "credits_remaining": "850.00",
                            "credits_used": "150.00",
                            "description": "Workspace for our startup team",
                            "display_name": "My Startup",
                            "enabled_member_count": 5,
                            "id": "550e8400-e29b-41d4-a716-446655440000",
                            "is_personal": false,
                            "owner_id": "550e8400-e29b-41d4-a716-446655440001",
                            "seat_count": 10,
                            "slug": "my-startup",
                            "status": "active",
                            "total_member_count": 7
                        }
                    ]
                }
            },
            "WorkspaceMemberResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "user_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "User Id"
                    },
                    "role": {
                        "$ref": "#/components/schemas/MemberRole"
                    },
                    "status": {
                        "$ref": "#/components/schemas/MemberStatus"
                    },
                    "joined_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Joined At"
                    },
                    "user_email": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "User Email"
                    },
                    "user_name": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "User Name"
                    },
                    "user_avatar_url": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "User Avatar Url"
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "user_id",
                    "role",
                    "status",
                    "joined_at"
                ],
                "title": "WorkspaceMemberResponse",
                "description": "Schema for workspace member response.",
                "example": {
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "joined_at": "2024-01-15T10:30:00Z",
                    "role": "admin",
                    "status": "enabled",
                    "user_avatar_url": "https://example.com/avatar.jpg",
                    "user_email": "john@example.com",
                    "user_id": "550e8400-e29b-41d4-a716-446655440001",
                    "user_name": "John Doe"
                }
            },
            "WorkspaceResponse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Id"
                    },
                    "display_name": {
                        "type": "string",
                        "title": "Display Name"
                    },
                    "slug": {
                        "type": "string",
                        "title": "Slug"
                    },
                    "status": {
                        "$ref": "#/components/schemas/WorkspaceStatus"
                    },
                    "is_personal": {
                        "type": "boolean",
                        "title": "Is Personal"
                    },
                    "description": {
                        "anyOf": [
                            {
                                "type": "string"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Description"
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "title": "Created At"
                    },
                    "owner_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Owner Id"
                    },
                    "enabled_member_count": {
                        "type": "integer",
                        "title": "Enabled Member Count",
                        "default": 0
                    },
                    "total_member_count": {
                        "type": "integer",
                        "title": "Total Member Count",
                        "default": 0
                    },
                    "seat_count": {
                        "type": "integer",
                        "title": "Seat Count",
                        "default": 0
                    },
                    "available_seats": {
                        "type": "integer",
                        "title": "Available Seats",
                        "default": 0
                    },
                    "credits_used": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Used",
                        "default": "0.00"
                    },
                    "credits_limit": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Limit",
                        "default": "0.00"
                    },
                    "credits_remaining": {
                        "type": "string",
                        "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$",
                        "title": "Credits Remaining",
                        "description": "Calculate remaining credits.",
                        "readOnly": true
                    },
                    "client_id": {
                        "type": "string",
                        "title": "Client Id",
                        "description": "Generate client ID from workspace ID (ws_<uuid_hex>).",
                        "readOnly": true
                    }
                },
                "type": "object",
                "required": [
                    "id",
                    "display_name",
                    "slug",
                    "status",
                    "is_personal",
                    "description",
                    "created_at",
                    "owner_id",
                    "credits_remaining",
                    "client_id"
                ],
                "title": "WorkspaceResponse",
                "description": "Schema for workspace response.",
                "example": {
                    "available_seats": 3,
                    "client_id": "ws_550e8400e29b41d4a716446655440000",
                    "created_at": "2024-01-15T10:30:00Z",
                    "credits_limit": "1000.00",
                    "credits_remaining": "850.00",
                    "credits_used": "150.00",
                    "description": "Workspace for our startup team",
                    "display_name": "My Startup",
                    "enabled_member_count": 5,
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "is_personal": false,
                    "owner_id": "550e8400-e29b-41d4-a716-446655440001",
                    "seat_count": 10,
                    "slug": "my-startup",
                    "status": "active",
                    "total_member_count": 7
                }
            },
            "WorkspaceStatus": {
                "type": "string",
                "enum": [
                    "active",
                    "frozen",
                    "suspended"
                ],
                "title": "WorkspaceStatus",
                "description": "Status of a workspace."
            },
            "WorkspaceUpdate": {
                "properties": {
                    "display_name": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 128,
                                "minLength": 1
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Display Name",
                        "description": "Workspace display name"
                    },
                    "slug": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 128,
                                "minLength": 1,
                                "pattern": "^[a-z0-9-]+$"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Slug",
                        "description": "URL-friendly workspace identifier"
                    },
                    "description": {
                        "anyOf": [
                            {
                                "type": "string",
                                "maxLength": 500
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Description",
                        "description": "Workspace description"
                    }
                },
                "type": "object",
                "title": "WorkspaceUpdate",
                "description": "Schema for updating a workspace.",
                "example": {
                    "description": "Updated workspace description",
                    "display_name": "My Startup Renamed",
                    "slug": "my-startup-renamed"
                }
            },
            "app__apps__cubex_api__schemas__workspace__UsageCommitRequest": {
                "properties": {
                    "api_key": {
                        "type": "string",
                        "title": "Api Key",
                        "description": "The API key that made the original request"
                    },
                    "usage_id": {
                        "type": "string",
                        "format": "uuid",
                        "title": "Usage Id",
                        "description": "The usage log ID to commit"
                    },
                    "success": {
                        "type": "boolean",
                        "title": "Success",
                        "description": "True if request succeeded, False if failed"
                    },
                    "metrics": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/UsageMetrics"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Optional metrics for successful requests"
                    },
                    "failure": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/FailureDetails"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Required failure details when success=False"
                    }
                },
                "type": "object",
                "required": [
                    "api_key",
                    "usage_id",
                    "success"
                ],
                "title": "UsageCommitRequest",
                "description": "Schema for committing API usage (internal endpoint).\n\nWhen success=True, optionally provide metrics (model, tokens, latency).\nWhen success=False, failure details are REQUIRED.",
                "example": {
                    "api_key": "cbx_live_abc123def456ghi789jkl012mno345pqr678stu901",
                    "metrics": {
                        "input_tokens": 1500,
                        "latency_ms": 1200,
                        "model_used": "gpt-4o",
                        "output_tokens": 500
                    },
                    "success": true,
                    "usage_id": "550e8400-e29b-41d4-a716-446655440000"
                }
            },
            "app__apps__cubex_api__schemas__workspace__UsageValidateRequest": {
                "properties": {
                    "request_id": {
                        "type": "string",
                        "title": "Request Id",
                        "description": "Globally unique request ID for idempotency"
                    },
                    "client_id": {
                        "type": "string",
                        "pattern": "^ws_[a-f0-9]{32}$",
                        "title": "Client Id",
                        "description": "Workspace client ID in format ws_<workspace_uuid_hex>"
                    },
                    "feature_key": {
                        "$ref": "#/components/schemas/FeatureKey",
                        "description": "Feature Key (e.g., 'api.analyze')"
                    },
                    "api_key": {
                        "type": "string",
                        "title": "Api Key",
                        "description": "The full API key to validate"
                    },
                    "endpoint": {
                        "type": "string",
                        "title": "Endpoint",
                        "description": "The API endpoint path being called"
                    },
                    "method": {
                        "type": "string",
                        "title": "Method",
                        "description": "HTTP method (GET, POST, etc.)"
                    },
                    "payload_hash": {
                        "type": "string",
                        "maxLength": 64,
                        "minLength": 64,
                        "pattern": "^[a-f0-9]{64}$",
                        "title": "Payload Hash",
                        "description": "SHA-256 hash of the request payload for fingerprinting"
                    },
                    "client": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/ClientInfo"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Optional client information"
                    },
                    "usage_estimate": {
                        "anyOf": [
                            {
                                "$ref": "#/components/schemas/UsageEstimate"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "description": "Optional usage estimation for the request"
                    }
                },
                "type": "object",
                "required": [
                    "request_id",
                    "client_id",
                    "feature_key",
                    "api_key",
                    "endpoint",
                    "method",
                    "payload_hash"
                ],
                "title": "UsageValidateRequest",
                "description": "Schema for validating API usage (internal endpoint).",
                "example": {
                    "api_key": "cbx_live_abc123def456ghi789jkl012mno345pqr678stu901",
                    "client": {
                        "ip": "102.89.1.22",
                        "user_agent": "Mozilla/5.0"
                    },
                    "client_id": "ws_550e8400e29b41d4a716446655440000",
                    "endpoint": "/v1/extract-cues/resume",
                    "feature_key": "api.analyze",
                    "method": "POST",
                    "payload_hash": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
                    "request_id": "req_9f0c2a7e-acde-4b9a-8b2f-83cc71a3c9a2",
                    "usage_estimate": {
                        "input_chars": 22000,
                        "max_output_tokens": 700,
                        "model": "gpt-4o-mini"
                    }
                }
            },
            "app__apps__cubex_career__schemas__internal__UsageValidateResponse": {
                "properties": {
                    "access": {
                        "$ref": "#/components/schemas/AccessStatus"
                    },
                    "user_id": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "uuid"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "User Id"
                    },
                    "usage_id": {
                        "anyOf": [
                            {
                                "type": "string",
                                "format": "uuid"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Usage Id"
                    },
                    "message": {
                        "type": "string",
                        "title": "Message"
                    },
                    "credits_reserved": {
                        "anyOf": [
                            {
                                "type": "string",
                                "pattern": "^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"
                            },
                            {
                                "type": "null"
                            }
                        ],
                        "title": "Credits Reserved",
                        "description": "The credits reserved/charged for this request"
                    }
                },
                "type": "object",
                "required": [
                    "access",
                    "user_id",
                    "usage_id",
                    "message"
                ],
                "title": "UsageValidateResponse",
                "description": "Schema for usage validation response.",
                "example": {
                    "access": "granted",
                    "credits_reserved": "1.5000",
                    "message": "Access granted. 98.50 credits remaining after this request.",
                    "usage_id": "550e8400-e29b-41d4-a716-446655440000",
                    "user_id": "550e8400-e29b-41d4-a716-446655440000"
                }
            }
        },
        "securitySchemes": {
            "HTTPBearer": {
                "type": "http",
                "scheme": "bearer"
            }
        }
    }
}